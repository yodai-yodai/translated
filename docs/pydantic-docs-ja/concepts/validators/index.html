
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Data validation using Python type hints">
      
      
      
        <link rel="canonical" href="https://docs.pydantic.dev/concepts/validators/">
      
      
        <link rel="prev" href="../serialization/">
      
      
        <link rel="next" href="../dataclasses/">
      
      
      <link rel="icon" href="../../favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.28">
    
    
      
        <title>Validators - Pydantic - 私家版日本語訳(翻訳元Pydantic Version:v2.8.2)</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../extra/terminal.css">
    
      <link rel="stylesheet" href="../../extra/tweaks.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="grey" data-md-color-accent="grey">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#annotated-validators" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Pydantic - 私家版日本語訳(翻訳元Pydantic Version:v2.8.2)" class="md-header__button md-logo" aria-label="Pydantic - 私家版日本語訳(翻訳元Pydantic Version:v2.8.2)" data-md-component="logo">
      
  <img src="../../logo-white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Pydantic - 私家版日本語訳(翻訳元Pydantic Version:v2.8.2)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Validators
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="grey" data-md-color-accent="grey"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="grey" data-md-color-accent="grey"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/pydantic/pydantic" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    pydantic/pydantic
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
  Get Started

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../models/" class="md-tabs__link">
          
  
  Concepts

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../api/base_model/" class="md-tabs__link">
          
  
  API Documentation

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../examples/secrets/" class="md-tabs__link">
          
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../errors/errors/" class="md-tabs__link">
          
  
  Error Messages

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../integrations/mypy/" class="md-tabs__link">
          
  
  Integrations

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="https://blog.pydantic.dev/" class="md-tabs__link">
        
  
    
  
  Blog

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../pydantic_people/" class="md-tabs__link">
        
  
    
  
  Pydantic People

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Pydantic - 私家版日本語訳(翻訳元Pydantic Version:v2.8.2)" class="md-nav__button md-logo" aria-label="Pydantic - 私家版日本語訳(翻訳元Pydantic Version:v2.8.2)" data-md-component="logo">
      
  <img src="../../logo-white.svg" alt="logo">

    </a>
    Pydantic - 私家版日本語訳(翻訳元Pydantic Version:v2.8.2)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/pydantic/pydantic" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    pydantic/pydantic
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Get Started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Get Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to Pydantic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../why/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Why use Pydantic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../help_with_pydantic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Help with Pydantic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../migration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Migration Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../version-policy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Version Policy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Concepts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Concepts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fields/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fields
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../json_schema/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JSON Schema
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../json/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JSON
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../unions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Unions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../alias/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Alias
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../serialization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Serialization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Validators
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Validators
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="Page contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Page contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#annotated-validators" class="md-nav__link">
    <span class="md-ellipsis">
      Annotated Validators
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Annotated Validators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#before-after-wrap-and-plain-validators" class="md-nav__link">
    <span class="md-ellipsis">
      Before, After, Wrap and Plain validators
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ordering-of-validators-within-annotated" class="md-nav__link">
    <span class="md-ellipsis">
      Ordering of validators within Annotated
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#validation-of-default-values" class="md-nav__link">
    <span class="md-ellipsis">
      Validation of default values
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#field-validators" class="md-nav__link">
    <span class="md-ellipsis">
      Field validators
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-validators" class="md-nav__link">
    <span class="md-ellipsis">
      Model validators
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#handling-errors-in-validators" class="md-nav__link">
    <span class="md-ellipsis">
      Handling errors in validators
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#special-types" class="md-nav__link">
    <span class="md-ellipsis">
      Special Types
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#field-checks" class="md-nav__link">
    <span class="md-ellipsis">
      Field checks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dataclass-validators" class="md-nav__link">
    <span class="md-ellipsis">
      Dataclass validators
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#validation-context" class="md-nav__link">
    <span class="md-ellipsis">
      Validation Context
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Validation Context">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-validation-context-with-basemodel-initialization" class="md-nav__link">
    <span class="md-ellipsis">
      Using validation context with BaseModel initialization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reusing-validators" class="md-nav__link">
    <span class="md-ellipsis">
      Reusing Validators
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataclasses/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dataclasses
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../postponed_annotations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Postponed Annotations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../strict_mode/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Strict Mode
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../type_adapter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Type Adapter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../validation_decorator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Validation Decorator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../conversion_table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Conversion Table
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pydantic_settings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Settings Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../performance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Performance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plugins/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pydantic Plugins
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../experimental/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Experimental
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Documentation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Pydantic
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Pydantic
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/base_model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BaseModel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/root_model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RootModel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/dataclasses/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pydantic Dataclasses
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/type_adapter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TypeAdapter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/validate_call/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Validate Call
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/fields/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fields
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/aliases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Aliases
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/json_schema/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JSON Schema
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/errors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Errors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/functional_validators/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Functional Validators
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/functional_serializers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Functional Serializers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/standard_library_types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Standard Library Types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pydantic Types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/networks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Network Types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/version/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Version Information
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/plugin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pydantic Plugins
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/annotated_handlers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Annotated Handlers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/experimental/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Experimental
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Pydantic Core
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Pydantic Core
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_core/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pydantic_core
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_core_schema/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pydantic_core.core_schema
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_settings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pydantic Settings
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Pydantic Extra Types
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Pydantic Extra Types
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_extra_types_color/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Color
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_extra_types_country/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Country
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_extra_types_payment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Payment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_extra_types_phone_numbers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Phone Numbers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_extra_types_routing_numbers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Routing Numbers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_extra_types_coordinate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Coordinate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_extra_types_mac_address/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mac Address
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_extra_types_isbn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ISBN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_extra_types_pendulum_dt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pendulum
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_extra_types_currency_code/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Currency
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_extra_types_language_code/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Language
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_extra_types_script_code/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Script Code
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_extra_types_semantic_version/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Semantic Version
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_extra_types_timezone_name/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timezone Name
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_extra_types_ulid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ULID
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/secrets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secrets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/validators/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Validators
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Error Messages
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Error Messages
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../errors/errors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Error Handling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../errors/validation_errors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Validation Errors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../errors/usage_errors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage Errors
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Integrations
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Integrations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
        
          
          <label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Dev Tools
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            Dev Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/mypy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mypy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/pycharm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyCharm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/hypothesis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hypothesis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/visual_studio_code/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Visual Studio Code
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/datamodel_code_generator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    datamodel-code-generator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/devtools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    devtools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/rich/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rich
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/linting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linting
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Production Tools
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            Production Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/aws_lambda/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AWS Lambda
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://blog.pydantic.dev/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blog
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pydantic_people/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pydantic People
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="Page contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Page contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#annotated-validators" class="md-nav__link">
    <span class="md-ellipsis">
      Annotated Validators
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Annotated Validators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#before-after-wrap-and-plain-validators" class="md-nav__link">
    <span class="md-ellipsis">
      Before, After, Wrap and Plain validators
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ordering-of-validators-within-annotated" class="md-nav__link">
    <span class="md-ellipsis">
      Ordering of validators within Annotated
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#validation-of-default-values" class="md-nav__link">
    <span class="md-ellipsis">
      Validation of default values
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#field-validators" class="md-nav__link">
    <span class="md-ellipsis">
      Field validators
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-validators" class="md-nav__link">
    <span class="md-ellipsis">
      Model validators
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#handling-errors-in-validators" class="md-nav__link">
    <span class="md-ellipsis">
      Handling errors in validators
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#special-types" class="md-nav__link">
    <span class="md-ellipsis">
      Special Types
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#field-checks" class="md-nav__link">
    <span class="md-ellipsis">
      Field checks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dataclass-validators" class="md-nav__link">
    <span class="md-ellipsis">
      Dataclass validators
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#validation-context" class="md-nav__link">
    <span class="md-ellipsis">
      Validation Context
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Validation Context">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-validation-context-with-basemodel-initialization" class="md-nav__link">
    <span class="md-ellipsis">
      Using validation context with BaseModel initialization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reusing-validators" class="md-nav__link">
    <span class="md-ellipsis">
      Reusing Validators
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                

                  

  
  


  <h1>Validators</h1>

<!-- BEGIN INCLUDE ../warning.md -->

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>本サイトのドキュメントは、<a href="https://docs.pydantic.dev/latest/">Pydantic</a>の日本語翻訳の私家版です。</p>
<p>内容に不審な点がある場合は、<a href="https://docs.pydantic.dev/latest/">Pydantic</a>のドキュメントを確認してください。</p>
<p>翻訳に使用したPydanticのバージョンは、v2.8.2になります。</p>
</div>
<!-- END INCLUDE -->

<h2 id="annotated-validators">Annotated Validators<a class="headerlink" href="#annotated-validators" title="Permanent link">&para;</a></h2>
<details class="api">
<summary>API Documentation</summary>
<p><a class="autorefs autorefs-internal" href="../../api/functional_validators/#pydantic.functional_validators.WrapValidator"><code>pydantic.functional_validators.WrapValidator</code></a><br>
<a class="autorefs autorefs-internal" href="../../api/functional_validators/#pydantic.functional_validators.PlainValidator"><code>pydantic.functional_validators.PlainValidator</code></a><br>
<a class="autorefs autorefs-internal" href="../../api/functional_validators/#pydantic.functional_validators.BeforeValidator"><code>pydantic.functional_validators.BeforeValidator</code></a><br>
<a class="autorefs autorefs-internal" href="../../api/functional_validators/#pydantic.functional_validators.AfterValidator"><code>pydantic.functional_validators.AfterValidator</code></a><br></p>
</details>
<!-- Pydantic provides a way to apply validators via use of `Annotated`.
You should use this whenever you want to bind validation to a type instead of model or field. -->
<p>Pydanticは<code>Annotated</code>を使用してバリデータを適用する方法を提供します。
検証をモデルまたはフィールドではなく型にバインドする場合は、この関数を使用してください。</p>
<div class="language-py highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">List</span>

<span class="kn">from</span> <span class="nn">typing_extensions</span> <span class="kn">import</span> <span class="n">Annotated</span>

<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">ValidationError</span>
<span class="kn">from</span> <span class="nn">pydantic.functional_validators</span> <span class="kn">import</span> <span class="n">AfterValidator</span>


<span class="k">def</span> <span class="nf">check_squares</span><span class="p">(</span><span class="n">v</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">assert</span> <span class="n">v</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">%</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s1"> is not a square number&#39;</span>
    <span class="k">return</span> <span class="n">v</span>


<span class="k">def</span> <span class="nf">double</span><span class="p">(</span><span class="n">v</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">v</span> <span class="o">*</span> <span class="mi">2</span>


<span class="n">MyNumber</span> <span class="o">=</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">AfterValidator</span><span class="p">(</span><span class="n">double</span><span class="p">),</span> <span class="n">AfterValidator</span><span class="p">(</span><span class="n">check_squares</span><span class="p">)]</span>


<span class="k">class</span> <span class="nc">DemoModel</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">number</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">MyNumber</span><span class="p">]</span>


<span class="nb">print</span><span class="p">(</span><span class="n">DemoModel</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">]))</span>
<span class="c1">#&gt; number=[4, 16]</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">DemoModel</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    1 validation error for DemoModel</span>
<span class="sd">    number.1</span>
<span class="sd">      Assertion failed, 8 is not a square number</span>
<span class="sd">    assert ((8 ** 0.5) % 1) == 0 [type=assertion_error, input_value=4, input_type=int]</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
<!-- In this example we used some type aliases (`MyNumber = Annotated[...]`).
While this can help with legibility of the code, it is not required, you can use `Annotated` directly in a model field type hint.
These type aliases are also not actual types but you can use a similar approach with `TypeAliasType` to create actual types.
See [Custom Types](../concepts/types.md#custom-types) for a more detailed explanation of custom types. -->
<p>この例では、いくつかの型エイリアス(<code>MyNumber=Annotated[...]</code>)を使用しました。
これはコードの読みやすさに役立ちますが、必須ではありません。モデルのフィールド型ヒントで直接<code>Annotated</code>を使用できます。
これらの型エイリアスも実際の型ではありませんが、<code>TypeAliasType</code>で同様のアプローチを使用して実際の型を作成できます。
カスタムタイプの詳細については、<a href="../types/#custom-types">Custom Types</a>を参照してください。</p>
<!-- It is also worth noting that you can nest `Annotated` inside other types.
In this example we used that to apply validation to the inner items of a list.
The same approach can be used for dict keys, etc. -->
<p><code>Annotated</code>を他の型の中にネストできることも注目に値します。
この例では、これを使用して、リストの内部項目に検証を適用しました。
同じアプローチをdictキーなどにも使用できます。</p>
<h3 id="before-after-wrap-and-plain-validators">Before, After, Wrap and Plain validators<a class="headerlink" href="#before-after-wrap-and-plain-validators" title="Permanent link">&para;</a></h3>
<!-- Pydantic provides multiple types of validator functions: -->
<p>Pydanticには複数のタイプのバリデータ関数が用意されています。</p>
<!-- * `After` validators run after Pydantic's internal parsing. They are generally more type safe and thus easier to implement.
* `Before` validators run before Pydantic's internal parsing and validation (e.g. coercion of a `str` to an `int`). These are more flexible than `After` validators since they can modify the raw input, but they also have to deal with the raw input, which in theory could be any arbitrary object.
* `Plain` validators are like a `mode='before'` validator but they terminate validation immediately, no further validators are called and Pydantic does not do any of its internal validation.
* `Wrap` validators are the most flexible of all. You can run code before or after Pydantic and other validators do their thing or you can terminate validation immediately, both with a successful value or an error. -->
<ul>
<li><code>After</code>バリデータは、Pydanticの内部解析の後に実行されます。一般的に型安全性が高いため、実装が簡単です。</li>
<li><code>Before</code>バリデータは、Pydanticの内部解析と検証の前に実行されます(例えば<code>str</code>の<code>int</code>への強制)。これらは生の入力を変更できるので<code>After</code>バリデータよりも柔軟ですが、理論的には任意のオブジェクトである生の入力も処理する必要があります。</li>
<li><code>Plain</code>バリデータは<code>mode='before'</code>バリデータのようなものですが、すぐに検証を終了し、それ以上のバリデータは呼び出されず、Pydanticは内部検証を行いません。</li>
<li><code>Wrap</code>バリデーターは、すべての中で最も柔軟です。Pydanticや他のバリデーターが処理を行う前または後にコードを実行することも、値が成功した場合やエラーが発生した場合に検証をすぐに終了することもできます。</li>
</ul>
<!-- You can use multiple before, after, or `mode='wrap'` validators, but only one `PlainValidator` since a plain validator will not call any inner validators. -->
<p>複数のbefore、after、または<code>mode='wrap'</code>バリデータを使用できますが、<code>PlainValidator</code>は1つだけです。これは、プレーンバリデータは内部バリデータを呼び出さないためです。</p>
<!-- Here's an example of a `mode='wrap'` validator: -->
<p>以下に<code>mode='wrap'</code>バリデータの例を示します。</p>
<div class="language-python highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">List</span>

<span class="kn">from</span> <span class="nn">typing_extensions</span> <span class="kn">import</span> <span class="n">Annotated</span>

<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">BaseModel</span><span class="p">,</span>
    <span class="n">ValidationError</span><span class="p">,</span>
    <span class="n">ValidationInfo</span><span class="p">,</span>
    <span class="n">ValidatorFunctionWrapHandler</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">pydantic.functional_validators</span> <span class="kn">import</span> <span class="n">WrapValidator</span>


<span class="k">def</span> <span class="nf">maybe_strip_whitespace</span><span class="p">(</span>
    <span class="n">v</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">handler</span><span class="p">:</span> <span class="n">ValidatorFunctionWrapHandler</span><span class="p">,</span> <span class="n">info</span><span class="p">:</span> <span class="n">ValidationInfo</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;json&#39;</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="s1">&#39;In JSON mode the input must be a string!&#39;</span>
        <span class="c1"># you can call the handler multiple times</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">handler</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ValidationError</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">handler</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
    <span class="k">assert</span> <span class="n">info</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;python&#39;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="s1">&#39;In Python mode the input must be an int!&#39;</span>
    <span class="c1"># do no further validation</span>
    <span class="k">return</span> <span class="n">v</span>


<span class="n">MyNumber</span> <span class="o">=</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">WrapValidator</span><span class="p">(</span><span class="n">maybe_strip_whitespace</span><span class="p">)]</span>


<span class="k">class</span> <span class="nc">DemoModel</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">number</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">MyNumber</span><span class="p">]</span>


<span class="nb">print</span><span class="p">(</span><span class="n">DemoModel</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">]))</span>
<span class="c1">#&gt; number=[2, 8]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">DemoModel</span><span class="o">.</span><span class="n">model_validate_json</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="s1">&#39;number&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39; 2 &#39;</span><span class="p">,</span> <span class="s1">&#39;8&#39;</span><span class="p">]})))</span>
<span class="c1">#&gt; number=[2, 8]</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">DemoModel</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;2&#39;</span><span class="p">])</span>
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    1 validation error for DemoModel</span>
<span class="sd">    number.0</span>
<span class="sd">      Assertion failed, In Python mode the input must be an int!</span>
<span class="sd">    assert False</span>
<span class="sd">     +  where False = isinstance(&#39;2&#39;, int) [type=assertion_error, input_value=&#39;2&#39;, input_type=str]</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
<p>The same "modes" apply to <code>@field_validator</code>, which is discussed in the next section.</p>
<!-- 同じ"モード"が`@field_validator`にも適用されます。これについては次のセクションで説明します。 -->

<h3 id="ordering-of-validators-within-annotated">Ordering of validators within <code>Annotated</code><a class="headerlink" href="#ordering-of-validators-within-annotated" title="Permanent link">&para;</a></h3>
<!-- Order of validation metadata within `Annotated` matters.
Validation goes from right to left and back.
That is, it goes from right to left running all "before" validators (or calling into "wrap" validators), then left to right back out calling all "after" validators. -->
<p>"注釈付き"事項内の検証メタデータの順序。
検証は右から左へ、そして逆方向に行われます。
つまり、右から左に向かってすべての"before"バリデーターを実行し(または"wrap"バリデーターを呼び出し)、左から右に戻ってすべての"after"バリデーターを呼び出します。</p>
<div class="language-py highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">cast</span>

<span class="kn">from</span> <span class="nn">typing_extensions</span> <span class="kn">import</span> <span class="n">Annotated</span><span class="p">,</span> <span class="n">TypedDict</span>

<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">AfterValidator</span><span class="p">,</span>
    <span class="n">BaseModel</span><span class="p">,</span>
    <span class="n">BeforeValidator</span><span class="p">,</span>
    <span class="n">PlainValidator</span><span class="p">,</span>
    <span class="n">ValidationInfo</span><span class="p">,</span>
    <span class="n">ValidatorFunctionWrapHandler</span><span class="p">,</span>
    <span class="n">WrapValidator</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">pydantic.functional_validators</span> <span class="kn">import</span> <span class="n">field_validator</span>


<span class="k">class</span> <span class="nc">Context</span><span class="p">(</span><span class="n">TypedDict</span><span class="p">):</span>
    <span class="n">logs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">make_validator</span><span class="p">(</span><span class="n">label</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">,</span> <span class="n">ValidationInfo</span><span class="p">],</span> <span class="n">Any</span><span class="p">]:</span>
    <span class="k">def</span> <span class="nf">validator</span><span class="p">(</span><span class="n">v</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">info</span><span class="p">:</span> <span class="n">ValidationInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="n">context</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">Context</span><span class="p">,</span> <span class="n">info</span><span class="o">.</span><span class="n">context</span><span class="p">)</span>
        <span class="n">context</span><span class="p">[</span><span class="s1">&#39;logs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span>

    <span class="k">return</span> <span class="n">validator</span>


<span class="k">def</span> <span class="nf">make_wrap_validator</span><span class="p">(</span>
    <span class="n">label</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">,</span> <span class="n">ValidatorFunctionWrapHandler</span><span class="p">,</span> <span class="n">ValidationInfo</span><span class="p">],</span> <span class="n">Any</span><span class="p">]:</span>
    <span class="k">def</span> <span class="nf">validator</span><span class="p">(</span>
        <span class="n">v</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">handler</span><span class="p">:</span> <span class="n">ValidatorFunctionWrapHandler</span><span class="p">,</span> <span class="n">info</span><span class="p">:</span> <span class="n">ValidationInfo</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="n">context</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">Context</span><span class="p">,</span> <span class="n">info</span><span class="o">.</span><span class="n">context</span><span class="p">)</span>
        <span class="n">context</span><span class="p">[</span><span class="s1">&#39;logs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">: pre&#39;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">handler</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="n">context</span><span class="p">[</span><span class="s1">&#39;logs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">: post&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">return</span> <span class="n">validator</span>


<span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="nb">str</span><span class="p">,</span>
        <span class="n">BeforeValidator</span><span class="p">(</span><span class="n">make_validator</span><span class="p">(</span><span class="s1">&#39;before-1&#39;</span><span class="p">)),</span>
        <span class="n">AfterValidator</span><span class="p">(</span><span class="n">make_validator</span><span class="p">(</span><span class="s1">&#39;after-1&#39;</span><span class="p">)),</span>
        <span class="n">WrapValidator</span><span class="p">(</span><span class="n">make_wrap_validator</span><span class="p">(</span><span class="s1">&#39;wrap-1&#39;</span><span class="p">)),</span>
        <span class="n">BeforeValidator</span><span class="p">(</span><span class="n">make_validator</span><span class="p">(</span><span class="s1">&#39;before-2&#39;</span><span class="p">)),</span>
        <span class="n">AfterValidator</span><span class="p">(</span><span class="n">make_validator</span><span class="p">(</span><span class="s1">&#39;after-2&#39;</span><span class="p">)),</span>
        <span class="n">WrapValidator</span><span class="p">(</span><span class="n">make_wrap_validator</span><span class="p">(</span><span class="s1">&#39;wrap-2&#39;</span><span class="p">)),</span>
        <span class="n">BeforeValidator</span><span class="p">(</span><span class="n">make_validator</span><span class="p">(</span><span class="s1">&#39;before-3&#39;</span><span class="p">)),</span>
        <span class="n">AfterValidator</span><span class="p">(</span><span class="n">make_validator</span><span class="p">(</span><span class="s1">&#39;after-3&#39;</span><span class="p">)),</span>
        <span class="n">WrapValidator</span><span class="p">(</span><span class="n">make_wrap_validator</span><span class="p">(</span><span class="s1">&#39;wrap-3&#39;</span><span class="p">)),</span>
        <span class="n">BeforeValidator</span><span class="p">(</span><span class="n">make_validator</span><span class="p">(</span><span class="s1">&#39;before-4&#39;</span><span class="p">)),</span>
        <span class="n">AfterValidator</span><span class="p">(</span><span class="n">make_validator</span><span class="p">(</span><span class="s1">&#39;after-4&#39;</span><span class="p">)),</span>
        <span class="n">WrapValidator</span><span class="p">(</span><span class="n">make_wrap_validator</span><span class="p">(</span><span class="s1">&#39;wrap-4&#39;</span><span class="p">)),</span>
    <span class="p">]</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="nb">str</span><span class="p">,</span>
        <span class="n">BeforeValidator</span><span class="p">(</span><span class="n">make_validator</span><span class="p">(</span><span class="s1">&#39;before-1&#39;</span><span class="p">)),</span>
        <span class="n">AfterValidator</span><span class="p">(</span><span class="n">make_validator</span><span class="p">(</span><span class="s1">&#39;after-1&#39;</span><span class="p">)),</span>
        <span class="n">WrapValidator</span><span class="p">(</span><span class="n">make_wrap_validator</span><span class="p">(</span><span class="s1">&#39;wrap-1&#39;</span><span class="p">)),</span>
        <span class="n">BeforeValidator</span><span class="p">(</span><span class="n">make_validator</span><span class="p">(</span><span class="s1">&#39;before-2&#39;</span><span class="p">)),</span>
        <span class="n">AfterValidator</span><span class="p">(</span><span class="n">make_validator</span><span class="p">(</span><span class="s1">&#39;after-2&#39;</span><span class="p">)),</span>
        <span class="n">WrapValidator</span><span class="p">(</span><span class="n">make_wrap_validator</span><span class="p">(</span><span class="s1">&#39;wrap-2&#39;</span><span class="p">)),</span>
        <span class="n">PlainValidator</span><span class="p">(</span><span class="n">make_validator</span><span class="p">(</span><span class="s1">&#39;plain&#39;</span><span class="p">)),</span>
        <span class="n">BeforeValidator</span><span class="p">(</span><span class="n">make_validator</span><span class="p">(</span><span class="s1">&#39;before-3&#39;</span><span class="p">)),</span>
        <span class="n">AfterValidator</span><span class="p">(</span><span class="n">make_validator</span><span class="p">(</span><span class="s1">&#39;after-3&#39;</span><span class="p">)),</span>
        <span class="n">WrapValidator</span><span class="p">(</span><span class="n">make_wrap_validator</span><span class="p">(</span><span class="s1">&#39;wrap-3&#39;</span><span class="p">)),</span>
        <span class="n">BeforeValidator</span><span class="p">(</span><span class="n">make_validator</span><span class="p">(</span><span class="s1">&#39;before-4&#39;</span><span class="p">)),</span>
        <span class="n">AfterValidator</span><span class="p">(</span><span class="n">make_validator</span><span class="p">(</span><span class="s1">&#39;after-4&#39;</span><span class="p">)),</span>
        <span class="n">WrapValidator</span><span class="p">(</span><span class="n">make_wrap_validator</span><span class="p">(</span><span class="s1">&#39;wrap-4&#39;</span><span class="p">)),</span>
    <span class="p">]</span>

    <span class="n">val_x_before</span> <span class="o">=</span> <span class="n">field_validator</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;before&#39;</span><span class="p">)(</span>
        <span class="n">make_validator</span><span class="p">(</span><span class="s1">&#39;val_x before&#39;</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">val_x_after</span> <span class="o">=</span> <span class="n">field_validator</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;after&#39;</span><span class="p">)(</span>
        <span class="n">make_validator</span><span class="p">(</span><span class="s1">&#39;val_x after&#39;</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">val_y_wrap</span> <span class="o">=</span> <span class="n">field_validator</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;wrap&#39;</span><span class="p">)(</span>
        <span class="n">make_wrap_validator</span><span class="p">(</span><span class="s1">&#39;val_y wrap&#39;</span><span class="p">)</span>
    <span class="p">)</span>


<span class="n">context</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span><span class="n">logs</span><span class="o">=</span><span class="p">[])</span>

<span class="n">A</span><span class="o">.</span><span class="n">model_validate</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="s1">&#39;abc&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="s1">&#39;def&#39;</span><span class="p">},</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">context</span><span class="p">[</span><span class="s1">&#39;logs&#39;</span><span class="p">])</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">[</span>
<span class="sd">    &#39;val_x before&#39;,</span>
<span class="sd">    &#39;wrap-4: pre&#39;,</span>
<span class="sd">    &#39;before-4&#39;,</span>
<span class="sd">    &#39;wrap-3: pre&#39;,</span>
<span class="sd">    &#39;before-3&#39;,</span>
<span class="sd">    &#39;wrap-2: pre&#39;,</span>
<span class="sd">    &#39;before-2&#39;,</span>
<span class="sd">    &#39;wrap-1: pre&#39;,</span>
<span class="sd">    &#39;before-1&#39;,</span>
<span class="sd">    &#39;after-1&#39;,</span>
<span class="sd">    &#39;wrap-1: post&#39;,</span>
<span class="sd">    &#39;after-2&#39;,</span>
<span class="sd">    &#39;wrap-2: post&#39;,</span>
<span class="sd">    &#39;after-3&#39;,</span>
<span class="sd">    &#39;wrap-3: post&#39;,</span>
<span class="sd">    &#39;after-4&#39;,</span>
<span class="sd">    &#39;wrap-4: post&#39;,</span>
<span class="sd">    &#39;val_x after&#39;,</span>
<span class="sd">    &#39;val_y wrap: pre&#39;,</span>
<span class="sd">    &#39;wrap-4: pre&#39;,</span>
<span class="sd">    &#39;before-4&#39;,</span>
<span class="sd">    &#39;wrap-3: pre&#39;,</span>
<span class="sd">    &#39;before-3&#39;,</span>
<span class="sd">    &#39;plain&#39;,</span>
<span class="sd">    &#39;after-3&#39;,</span>
<span class="sd">    &#39;wrap-3: post&#39;,</span>
<span class="sd">    &#39;after-4&#39;,</span>
<span class="sd">    &#39;wrap-4: post&#39;,</span>
<span class="sd">    &#39;val_y wrap: post&#39;,</span>
<span class="sd">]</span>
<span class="sd">&quot;&quot;&quot;</span>
</code></pre></div>
<h2 id="validation-of-default-values">Validation of default values<a class="headerlink" href="#validation-of-default-values" title="Permanent link">&para;</a></h2>
<!-- Validators won't run when the default value is used.
This applies both to `@field_validator` validators and `Annotated` validators.
You can force them to run with `Field(validate_default=True)`. Setting `validate_default` to `True` has the closest behavior to using `always=True` in `validator` in Pydantic v1. However, you are generally better off using a `@model_validator(mode='before')` where the function is called before the inner validator is called. -->
<p>デフォルト値を使用すると、バリデータは実行されません。
これは<code>@field_validator</code>バリデータと<code>Annotated</code>バリデータの両方に適用されます。
<code>Field(validate_default=True)</code>で強制的に実行させることができます。<code>validate_default</code>を<code>True</code>に設定することは、Pydantic v1の<code>validator</code>で<code>always=True</code>を使用することに最も近い動作をします。ただし、一般的には、内部バリデータが呼び出される前に関数が呼び出される<code>@model_validator(mode='before')</code>を使用する方がよいでしょう。</p>
<div class="language-py highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing_extensions</span> <span class="kn">import</span> <span class="n">Annotated</span>

<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">Field</span><span class="p">,</span> <span class="n">field_validator</span>


<span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">x</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;abc&#39;</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Field</span><span class="p">(</span><span class="n">validate_default</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span> <span class="o">=</span> <span class="s1">&#39;xyz&#39;</span>

    <span class="nd">@field_validator</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">double</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">v</span> <span class="o">*</span> <span class="mi">2</span>


<span class="nb">print</span><span class="p">(</span><span class="n">Model</span><span class="p">())</span>
<span class="c1">#&gt; x=&#39;abc&#39; y=&#39;xyzxyz&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Model</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">))</span>
<span class="c1">#&gt; x=&#39;foofoo&#39; y=&#39;xyzxyz&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Model</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;abc&#39;</span><span class="p">))</span>
<span class="c1">#&gt; x=&#39;abcabc&#39; y=&#39;xyzxyz&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Model</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">))</span>
<span class="c1">#&gt; x=&#39;foofoo&#39; y=&#39;barbar&#39;</span>
</code></pre></div>
<h2 id="field-validators">Field validators<a class="headerlink" href="#field-validators" title="Permanent link">&para;</a></h2>
<details class="api">
<summary>API Documentation</summary>
<p><a class="autorefs autorefs-internal" href="../../api/functional_validators/#pydantic.functional_validators.field_validator"><code>pydantic.functional_validators.field_validator</code></a><br></p>
</details>
<!-- If you want to attach a validator to a specific field of a model you can use the `@field_validator` decorator. -->
<p>モデルの特定のフィールドにバリデータを付加したい場合は、<code>@field_validator</code>デコレータを使用できます。</p>
<div class="language-py highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">BaseModel</span><span class="p">,</span>
    <span class="n">ValidationError</span><span class="p">,</span>
    <span class="n">ValidationInfo</span><span class="p">,</span>
    <span class="n">field_validator</span><span class="p">,</span>
<span class="p">)</span>


<span class="k">class</span> <span class="nc">UserModel</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span>

    <span class="nd">@field_validator</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">name_must_contain_space</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39; &#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;must contain a space&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>

    <span class="c1"># you can select multiple fields, or use &#39;*&#39; to select all fields</span>
    <span class="nd">@field_validator</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">)</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">check_alphanumeric</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">info</span><span class="p">:</span> <span class="n">ValidationInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="c1"># info.field_name is the name of the field being validated</span>
            <span class="n">is_alphanumeric</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span>
            <span class="k">assert</span> <span class="n">is_alphanumeric</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">info</span><span class="o">.</span><span class="n">field_name</span><span class="si">}</span><span class="s1"> must be alphanumeric&#39;</span>
        <span class="k">return</span> <span class="n">v</span>


<span class="nb">print</span><span class="p">(</span><span class="n">UserModel</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;John Doe&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="c1">#&gt; name=&#39;John Doe&#39; id=1</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">UserModel</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;samuel&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    1 validation error for UserModel</span>
<span class="sd">    name</span>
<span class="sd">      Value error, must contain a space [type=value_error, input_value=&#39;samuel&#39;, input_type=str]</span>
<span class="sd">    &quot;&quot;&quot;</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">UserModel</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;John Doe&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;abc&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    1 validation error for UserModel</span>
<span class="sd">    id</span>
<span class="sd">      Input should be a valid integer, unable to parse string as an integer [type=int_parsing, input_value=&#39;abc&#39;, input_type=str]</span>
<span class="sd">    &quot;&quot;&quot;</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">UserModel</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;John Doe!&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    1 validation error for UserModel</span>
<span class="sd">    name</span>
<span class="sd">      Assertion failed, name must be alphanumeric</span>
<span class="sd">    assert False [type=assertion_error, input_value=&#39;John Doe!&#39;, input_type=str]</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
<!-- A few things to note on validators: -->
<p>バリデータに関して注意すべき点がいくつかあります。</p>
<!-- * `@field_validator`s are "class methods", so the first argument value they receive is the `UserModel` class, not an instance of `UserModel`. We recommend you use the `@classmethod` decorator on them below the `@field_validator` decorator to get proper type checking.
* the second argument is the field value to validate; it can be named as you please
* the third argument, if present, is an instance of `pydantic.ValidationInfo`
* validators should either return the parsed value or raise a `ValueError` or `AssertionError` (``assert`` statements may be used).
* A single validator can be applied to multiple fields by passing it multiple field names.
* A single validator can also be called on *all* fields by passing the special value `'*'`. -->
<ul>
<li><code>@field_validator</code>は"クラスメソッド"であるため、受け取る最初の引数値は<code>UserModel</code>クラスであり、<code>UserModel</code>のインスタンスではありません。適切な型チェックを行うには、<code>@field_validator</code>デコレータの下で<code>@classmethod</code>デコレータを使用することをお勧めします。</li>
<li>2番目の引数は検証するフィールド値です。任意の名前を付けることができます。</li>
<li>3番目の引数が存在する場合は、<code>pydantic.ValidationInfo</code>のインスタンスです。</li>
<li>バリデータは解析された値を返すか、<code>ValueError</code>または<code>AssertionError</code>を送出する必要があります(<code>assert</code>文を使用することもできます)。</li>
<li>1つのバリデータを複数のフィールドに適用するには、複数のフィールド名を渡します。</li>
<li>特殊な値<code>'*'</code>を渡すことで、<em>すべての</em>フィールドに対して単一のバリデータを呼び出すこともできます。</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><!-- If you make use of <code>assert</code> statements, keep in mind that running Python with the <a href="https://docs.python.org/3/using/cmdline.html#cmdoption-o">klzzwxh:0093 optimization flag</a> disables <code>assert</code> statements, and **validators will stop working**. -->
<code>assert</code>文を使用する場合、<a href="https://docs.python.org/3/using/cmdline.html#cmdoption-o"><code>-O</code> optimization flag</a>を付けてPythonを実行すると<code>assert</code>文が無効になり、<strong>バリデータが動作しなくなる</strong>ことに注意してください。</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><!-- <code>FieldValidationInfo</code> is **deprecated** in 2.4, use <code>ValidationInfo</code> instead. -->
<code>FieldValidationInfo</code>は2.4で<strong>廃止されました</strong>。代わりに<code>ValidationInfo</code>を使用してください。</p>
</div>
<!-- If you want to access values from another field inside a `@field_validator`, this may be possible using `ValidationInfo.data`, which is a dict of field name to field value.
Validation is done in the order fields are defined, so you have to be careful when using `ValidationInfo.data` to not access a field that has not yet been validated/populated — in the code above, for example, you would not be able to access `info.data['id']` from within `name_must_contain_space`.
However, in most cases where you want to perform validation using multiple field values, it is better to use `@model_validator` which is discussed in the section below. -->
<p><code>@field_validator</code>内の別のフィールドの値にアクセスしたい場合は、フィールド名からフィールド値への辞書である<code>ValidationInfo.data</code>を使用することができます。
検証はフィールドが定義された順序で行われるので、<code>ValidationInfo.data</code>を使用するときは、まだ検証/入力されていないフィールドにアクセスしないように注意する必要があります。たとえば、上記のコードでは、<code>name_must_contain_space</code>内から<code>info.data['id']</code>にアクセスすることはできません。
ただし、複数のフィールド値を使用して検証を実行する場合は、以下のセクションで説明する<code>@model_validator</code>を使用することをお勧めします。</p>
<h2 id="model-validators">Model validators<a class="headerlink" href="#model-validators" title="Permanent link">&para;</a></h2>
<details class="api">
<summary>API Documentation</summary>
<p><a class="autorefs autorefs-internal" href="../../api/functional_validators/#pydantic.functional_validators.model_validator"><code>pydantic.functional_validators.model_validator</code></a><br></p>
</details>
<!-- Validation can also be performed on the entire model's data using `@model_validator`. -->
<p>検証は、<code>@model_validator</code>を使用してモデルのデータ全体に対して実行することもできます。</p>
<div class="language-py highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span>

<span class="kn">from</span> <span class="nn">typing_extensions</span> <span class="kn">import</span> <span class="n">Self</span>

<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">ValidationError</span><span class="p">,</span> <span class="n">model_validator</span>


<span class="k">class</span> <span class="nc">UserModel</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">username</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">password1</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">password2</span><span class="p">:</span> <span class="nb">str</span>

    <span class="nd">@model_validator</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;before&#39;</span><span class="p">)</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">check_card_number_omitted</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">assert</span> <span class="p">(</span>
                <span class="s1">&#39;card_number&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span>
            <span class="p">),</span> <span class="s1">&#39;card_number should not be included&#39;</span>
        <span class="k">return</span> <span class="n">data</span>

    <span class="nd">@model_validator</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;after&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">check_passwords_match</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
        <span class="n">pw1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">password1</span>
        <span class="n">pw2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">password2</span>
        <span class="k">if</span> <span class="n">pw1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">pw2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">pw1</span> <span class="o">!=</span> <span class="n">pw2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;passwords do not match&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>


<span class="nb">print</span><span class="p">(</span><span class="n">UserModel</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s1">&#39;scolvin&#39;</span><span class="p">,</span> <span class="n">password1</span><span class="o">=</span><span class="s1">&#39;zxcvbn&#39;</span><span class="p">,</span> <span class="n">password2</span><span class="o">=</span><span class="s1">&#39;zxcvbn&#39;</span><span class="p">))</span>
<span class="c1">#&gt; username=&#39;scolvin&#39; password1=&#39;zxcvbn&#39; password2=&#39;zxcvbn&#39;</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">UserModel</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s1">&#39;scolvin&#39;</span><span class="p">,</span> <span class="n">password1</span><span class="o">=</span><span class="s1">&#39;zxcvbn&#39;</span><span class="p">,</span> <span class="n">password2</span><span class="o">=</span><span class="s1">&#39;zxcvbn2&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    1 validation error for UserModel</span>
<span class="sd">      Value error, passwords do not match [type=value_error, input_value={&#39;username&#39;: &#39;scolvin&#39;, &#39;... &#39;password2&#39;: &#39;zxcvbn2&#39;}, input_type=dict]</span>
<span class="sd">    &quot;&quot;&quot;</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">UserModel</span><span class="p">(</span>
        <span class="n">username</span><span class="o">=</span><span class="s1">&#39;scolvin&#39;</span><span class="p">,</span>
        <span class="n">password1</span><span class="o">=</span><span class="s1">&#39;zxcvbn&#39;</span><span class="p">,</span>
        <span class="n">password2</span><span class="o">=</span><span class="s1">&#39;zxcvbn&#39;</span><span class="p">,</span>
        <span class="n">card_number</span><span class="o">=</span><span class="s1">&#39;1234&#39;</span><span class="p">,</span>
    <span class="p">)</span>
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    1 validation error for UserModel</span>
<span class="sd">      Assertion failed, card_number should not be included</span>
<span class="sd">    assert &#39;card_number&#39; not in {&#39;card_number&#39;: &#39;1234&#39;, &#39;password1&#39;: &#39;zxcvbn&#39;, &#39;password2&#39;: &#39;zxcvbn&#39;, &#39;username&#39;: &#39;scolvin&#39;} [type=assertion_error, input_value={&#39;username&#39;: &#39;scolvin&#39;, &#39;..., &#39;card_number&#39;: &#39;1234&#39;}, input_type=dict]</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">On return type checking</p>
<p><!-- Methods decorated with <code>@model_validator</code> should return the self instance at the end of the method.
For type checking purposes, you can use <code>Self</code> from either <code>typing</code> or the <code>typing_extensions</code> backport as the return type of the decorated method.
In the context of the above example, you could also use <code>def check_passwords_match(self: 'UserModel') -&gt; 'UserModel'</code> to indicate that the method returns an instance of the model. -->
<code>@model_validator</code>でデコレートされたメソッドは、メソッドの最後にselfインスタンスを返します。
型チェックの目的で、デコレートされたメソッドの戻り値の型として<code>typing</code>または<code>typing_extensions</code>バックポートから<code>Self</code>を使用できます。
上記の例では、<code>def check_passwords_match(self:'UserModel')-&gt;'UserModel'</code>を使用して、メソッドがモデルのインスタンスを返すことを示すこともできます。</p>
</div>
<div class="admonition note">
<p class="admonition-title">On Inheritance</p>
<p><!-- A <code>@model_validator</code> defined in a base class will be called during the validation of a subclass instance. -->
基底クラスで定義された<code>@model_validator</code>は、サブクラスインスタンスの検証中に呼び出されます。</p>
<p><!-- Overriding a <code>@model_validator</code> in a subclass will override the base class' <code>@model_validator</code>, and thus only the subclass' version of said <code>@model_validator</code> will be called. -->
サブクラスの<code>@model_validator</code>をオーバーライドすると、ベースクラスの'<code>@model_validator</code>がオーバーライドされるので、その<code>@model_validator</code>のサブクラスのバージョンだけが呼び出されます。</p>
</div>
<!-- Model validators can be `mode='before'`, `mode='after'` or `mode='wrap'`. -->
<p>モデルバリデータは<code>mode='before'</code>,<code>mode='after'</code>,<code>mode='wrap'</code>のいずれかです。</p>
<!-- Before model validators are passed the raw input which is often a `dict[str, Any]` but could also be an instance of the model itself (e.g. if `UserModel.model_validate(UserModel.construct(...))` is called) or anything else since you can pass arbitrary objects into `model_validate`.
Because of this `mode='before'` validators are extremely flexible and powerful but can be cumbersome and error prone to implement.
Before model validators should be class methods.
The first argument should be `cls` (and we also recommend you use `@classmethod` below `@model_validator` for proper type checking), the second argument will be the input (you should generally type it as `Any` and use `isinstance` to narrow the type) and the third argument (if present) will be a `pydantic.ValidationInfo`. -->
<p>モデルバリデータが渡される前に、生の入力が渡されます。これは<code>dict[str, Any]</code>であることがよくありますが、モデル自体のインスタンスであることもあります(例えば<code>UserModel.model_validate(UserModel.construct(...))</code>が呼び出された場合)。また、<code>model_validate</code>には任意のオブジェクトを渡すことができるので、その他のものでもかまいません。
このため、<code>mode='before'</code>バリデータは非常に柔軟で強力ですが、実装が煩雑でエラーが発生しやすくなります。
モデルの前では、バリデーターはクラスメソッドでなければなりません。
最初の引数は<code>cls</code>でなければならず(適切な型チェックのために<code>@model_validator</code>の下に<code>@classmethod</code>を使用することもお勧めします)、2番目の引数は入力になり(通常は<code>Any</code>と入力し、型を絞り込むために<code>isinstance</code>を使用します)、3番目の引数(存在する場合)は<code>pydantic.ValidationInfo</code>になります。</p>
<!-- `mode='after'` validators are instance methods and always receive an instance of the model as the first argument. Be sure to return the instance at the end of your validator.
You should not use `(cls, ModelType)` as the signature, instead just use `(self)` and let type checkers infer the type of `self` for you.
Since these are fully type safe they are often easier to implement than `mode='before'` validators.
If any field fails to validate, `mode='after'` validators for that field will not be called. -->
<p><code>mode='after'</code>バリデータはインスタンスメソッドであり、常に最初の引数としてモデルのインスタンスを受け取ります。バリデータの最後に必ずインスタンスを返してください。
署名として<code>(cls, ModelType)</code>を使うべきではなく、単に<code>(self)</code>を使って、型チェッカーに<code>self</code>の型を推測させてください。
これらは完全に型安全なので、<code>mode='before'</code>バリデータよりも実装しやすいことがよくあります。
検証に失敗したフィールドがある場合、そのフィールドの<code>mode='after'</code>バリデータは呼び出されません。</p>
<h2 id="handling-errors-in-validators">Handling errors in validators<a class="headerlink" href="#handling-errors-in-validators" title="Permanent link">&para;</a></h2>
<!-- As mentioned in the previous sections you can raise either a `ValueError` or `AssertionError` (including ones generated by `assert ...` statements) within a validator to indicate validation failed.
You can also raise a `PydanticCustomError` which is a bit more verbose but gives you extra flexibility.
Any other errors (including `TypeError`) are bubbled up and not wrapped in a `ValidationError`. -->
<p>前のセクションで説明したように、バリデータ内で<code>ValueError</code>または<code>AssertionError</code>(<code>assert...</code>文によって生成されたものを含む)を発生させて、検証が失敗したことを示すことができます。
<code>PydanticCustomError</code>を発生させることもできます。これはもう少し冗長ですが、より柔軟性があります。
その他のエラー(<code>TypeError</code>を含む)はバブルアップされ、<code>ValidationError</code>にラップされません。</p>
<div class="language-python highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pydantic_core</span> <span class="kn">import</span> <span class="n">PydanticCustomError</span>

<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">ValidationError</span><span class="p">,</span> <span class="n">field_validator</span>


<span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">x</span><span class="p">:</span> <span class="nb">int</span>

    <span class="nd">@field_validator</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">validate_x</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">v</span> <span class="o">%</span> <span class="mi">42</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PydanticCustomError</span><span class="p">(</span>
                <span class="s1">&#39;the_answer_error&#39;</span><span class="p">,</span>
                <span class="s1">&#39;</span><span class="si">{number}</span><span class="s1"> is the answer!&#39;</span><span class="p">,</span>
                <span class="p">{</span><span class="s1">&#39;number&#39;</span><span class="p">:</span> <span class="n">v</span><span class="p">},</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span>


<span class="k">try</span><span class="p">:</span>
    <span class="n">Model</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">42</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    1 validation error for Model</span>
<span class="sd">    x</span>
<span class="sd">      84 is the answer! [type=the_answer_error, input_value=84, input_type=int]</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
<h2 id="special-types">Special Types<a class="headerlink" href="#special-types" title="Permanent link">&para;</a></h2>
<!-- Pydantic provides a few special types that can be used to customize validation. -->
<p>Pydanticには、検証をカスタマイズするために使用できる特殊な型がいくつか用意されています。</p>
<!-- - [`InstanceOf`][pydantic.functional_validators.InstanceOf] is a type that can be used to validate that a value is an instance of a given class. -->
<ul>
<li><a class="autorefs autorefs-internal" href="../../api/functional_validators/#pydantic.functional_validators.InstanceOf"><code>InstanceOf</code></a>は、値が指定されたクラスのインスタンスであることを検証するために使用できる型です。</li>
</ul>
<div class="language-py highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>

<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">InstanceOf</span><span class="p">,</span> <span class="n">ValidationError</span>


<span class="k">class</span> <span class="nc">Fruit</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>


<span class="k">class</span> <span class="nc">Banana</span><span class="p">(</span><span class="n">Fruit</span><span class="p">):</span> <span class="o">...</span>


<span class="k">class</span> <span class="nc">Apple</span><span class="p">(</span><span class="n">Fruit</span><span class="p">):</span> <span class="o">...</span>


<span class="k">class</span> <span class="nc">Basket</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">fruits</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">InstanceOf</span><span class="p">[</span><span class="n">Fruit</span><span class="p">]]</span>


<span class="nb">print</span><span class="p">(</span><span class="n">Basket</span><span class="p">(</span><span class="n">fruits</span><span class="o">=</span><span class="p">[</span><span class="n">Banana</span><span class="p">(),</span> <span class="n">Apple</span><span class="p">()]))</span>
<span class="c1">#&gt; fruits=[Banana, Apple]</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">Basket</span><span class="p">(</span><span class="n">fruits</span><span class="o">=</span><span class="p">[</span><span class="n">Banana</span><span class="p">(),</span> <span class="s1">&#39;Apple&#39;</span><span class="p">])</span>
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    1 validation error for Basket</span>
<span class="sd">    fruits.1</span>
<span class="sd">      Input should be an instance of Fruit [type=is_instance_of, input_value=&#39;Apple&#39;, input_type=str]</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
<!-- - [`SkipValidation`][pydantic.functional_validators.SkipValidation] is a type that can be used to skip validation on a field. -->
<ul>
<li><a class="autorefs autorefs-internal" href="../../api/functional_validators/#pydantic.functional_validators.SkipValidation"><code>SkipValidation</code></a>は、フィールドの検証をスキップするために使用できる型です。</li>
</ul>
<div class="language-py highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>

<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">SkipValidation</span>


<span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">SkipValidation</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>


<span class="n">m</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="c1">#&gt; names=[&#39;foo&#39;, &#39;bar&#39;]</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="mi">123</span><span class="p">])</span>  <span class="c1"># (1)!</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="c1">#&gt; names=[&#39;foo&#39;, 123]</span>
</code></pre></div>
<!-- 1. Note that the validation of the second item is skipped. If it has the wrong type it will emit a warning during serialization. -->
<ol>
<li>2番目のアイテムの検証はスキップされることに注意してください。タイプが間違っている場合は、シリアル化中に警告が表示されます。</li>
</ol>
<h2 id="field-checks">Field checks<a class="headerlink" href="#field-checks" title="Permanent link">&para;</a></h2>
<!-- During class creation, validators are checked to confirm that the fields they specify actually exist on the model. -->
<p>クラスの作成中に、指定されたフィールドが実際にモデル上に存在することを確認するためにバリデーターがチェックされます。</p>
<!-- This may be undesirable if, for example, you want to define a validator to validate fields that will only be present on subclasses of the model where the validator is defined. -->
<p>これは、たとえば、バリデータが定義されているモデルのサブクラスにのみ存在するフィールドを検証するバリデータを定義する場合には望ましくないことがあります。</p>
<!-- If you want to disable these checks during class creation, you can pass `check_fields=False` as a keyword argument to the validator. -->
<p>クラスの作成中にこれらのチェックを無効にしたい場合は、<code>check_fields=False</code>をキーワード引数としてバリデータに渡すことができます。</p>
<h2 id="dataclass-validators">Dataclass validators<a class="headerlink" href="#dataclass-validators" title="Permanent link">&para;</a></h2>
<!-- Validators also work with Pydantic dataclasses. -->
<p>バリデーターはPydanticデータ・クラスでも動作します。</p>
<div class="language-py highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">field_validator</span>
<span class="kn">from</span> <span class="nn">pydantic.dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">DemoDataclass</span><span class="p">:</span>
    <span class="n">product_id</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># should be a five-digit string, may have leading zeros</span>

    <span class="nd">@field_validator</span><span class="p">(</span><span class="s1">&#39;product_id&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;before&#39;</span><span class="p">)</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">convert_int_serial</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">v</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span>


<span class="nb">print</span><span class="p">(</span><span class="n">DemoDataclass</span><span class="p">(</span><span class="n">product_id</span><span class="o">=</span><span class="s1">&#39;01234&#39;</span><span class="p">))</span>
<span class="c1">#&gt; DemoDataclass(product_id=&#39;01234&#39;)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">DemoDataclass</span><span class="p">(</span><span class="n">product_id</span><span class="o">=</span><span class="mi">2468</span><span class="p">))</span>
<span class="c1">#&gt; DemoDataclass(product_id=&#39;02468&#39;)</span>
</code></pre></div>
<h2 id="validation-context">Validation Context<a class="headerlink" href="#validation-context" title="Permanent link">&para;</a></h2>
<!-- You can pass a context object to the validation methods which can be accessed from the `info` argument to decorated validator functions: -->
<p>デコレートされたバリデータ関数の<code>info</code>引数からアクセスできる検証メソッドにコンテキストオブジェクトを渡すことができます。</p>
<div class="language-python highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">ValidationInfo</span><span class="p">,</span> <span class="n">field_validator</span>


<span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">text</span><span class="p">:</span> <span class="nb">str</span>

    <span class="nd">@field_validator</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">remove_stopwords</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">info</span><span class="p">:</span> <span class="n">ValidationInfo</span><span class="p">):</span>
        <span class="n">context</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">context</span>
        <span class="k">if</span> <span class="n">context</span><span class="p">:</span>
            <span class="n">stopwords</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;stopwords&#39;</span><span class="p">,</span> <span class="nb">set</span><span class="p">())</span>
            <span class="n">v</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">w</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">if</span> <span class="n">w</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stopwords</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span>


<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s1">&#39;This is an example document&#39;</span><span class="p">}</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Model</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>  <span class="c1"># no context</span>
<span class="c1">#&gt; text=&#39;This is an example document&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Model</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;stopwords&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;this&#39;</span><span class="p">,</span> <span class="s1">&#39;is&#39;</span><span class="p">,</span> <span class="s1">&#39;an&#39;</span><span class="p">]}))</span>
<span class="c1">#&gt; text=&#39;example document&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Model</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;stopwords&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;document&#39;</span><span class="p">]}))</span>
<span class="c1">#&gt; text=&#39;This is an example&#39;</span>
</code></pre></div>
<!-- This is useful when you need to dynamically update the validation behavior during runtime. For example, if you wanted a field to have a dynamically controllable set of allowed values, this could be done by passing the allowed values by context, and having a separate mechanism for updating what is allowed: -->
<p>これは、実行時に検証動作を動的に更新する必要がある場合に便利です。たとえば、フィールドに動的に制御可能な許可された値のセットを持たせたい場合、コンテキストによって許可された値を渡し、許可されたものを更新するための別のメカニズムを持つことによって、これを行うことができます。</p>
<div class="language-python highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span>

<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">BaseModel</span><span class="p">,</span>
    <span class="n">ValidationError</span><span class="p">,</span>
    <span class="n">ValidationInfo</span><span class="p">,</span>
    <span class="n">field_validator</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">_allowed_choices</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">set_allowed_choices</span><span class="p">(</span><span class="n">allowed_choices</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">global</span> <span class="n">_allowed_choices</span>
    <span class="n">_allowed_choices</span> <span class="o">=</span> <span class="n">allowed_choices</span>


<span class="k">def</span> <span class="nf">get_context</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;allowed_choices&#39;</span><span class="p">:</span> <span class="n">_allowed_choices</span><span class="p">}</span>


<span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">choice</span><span class="p">:</span> <span class="nb">str</span>

    <span class="nd">@field_validator</span><span class="p">(</span><span class="s1">&#39;choice&#39;</span><span class="p">)</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">validate_choice</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">info</span><span class="p">:</span> <span class="n">ValidationInfo</span><span class="p">):</span>
        <span class="n">allowed_choices</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;allowed_choices&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">allowed_choices</span> <span class="ow">and</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_choices</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;choice must be one of </span><span class="si">{</span><span class="n">allowed_choices</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span>


<span class="nb">print</span><span class="p">(</span><span class="n">Model</span><span class="o">.</span><span class="n">model_validate</span><span class="p">({</span><span class="s1">&#39;choice&#39;</span><span class="p">:</span> <span class="s1">&#39;a&#39;</span><span class="p">},</span> <span class="n">context</span><span class="o">=</span><span class="n">get_context</span><span class="p">()))</span>
<span class="c1">#&gt; choice=&#39;a&#39;</span>

<span class="k">try</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">Model</span><span class="o">.</span><span class="n">model_validate</span><span class="p">({</span><span class="s1">&#39;choice&#39;</span><span class="p">:</span> <span class="s1">&#39;d&#39;</span><span class="p">},</span> <span class="n">context</span><span class="o">=</span><span class="n">get_context</span><span class="p">()))</span>
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    1 validation error for Model</span>
<span class="sd">    choice</span>
<span class="sd">      Value error, choice must be one of [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;] [type=value_error, input_value=&#39;d&#39;, input_type=str]</span>
<span class="sd">    &quot;&quot;&quot;</span>

<span class="n">set_allowed_choices</span><span class="p">([</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>

<span class="k">try</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">Model</span><span class="o">.</span><span class="n">model_validate</span><span class="p">({</span><span class="s1">&#39;choice&#39;</span><span class="p">:</span> <span class="s1">&#39;a&#39;</span><span class="p">},</span> <span class="n">context</span><span class="o">=</span><span class="n">get_context</span><span class="p">()))</span>
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    1 validation error for Model</span>
<span class="sd">    choice</span>
<span class="sd">      Value error, choice must be one of [&#39;b&#39;, &#39;c&#39;] [type=value_error, input_value=&#39;a&#39;, input_type=str]</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
<!-- Similarly, you can [use a context for serialization](../concepts/serialization.md#serialization-context). -->
<p>同様に、[use a context for serialization]こともできます(../concepts/serialization.md#serialization-context)。</p>
<h3 id="using-validation-context-with-basemodel-initialization">Using validation context with <code>BaseModel</code> initialization<a class="headerlink" href="#using-validation-context-with-basemodel-initialization" title="Permanent link">&para;</a></h3>
<!-- Although there is no way to specify a context in the standard `BaseModel` initializer, you can work around this through the use of `contextvars.ContextVar` and a custom `__init__` method: -->
<p>標準の<code>BaseModel</code>イニシャライザでコンテキストを指定する方法はありませんが、<code>contextvars.ContextVar</code>とカスタムの<code>__init__</code>メソッドを使用してこれを回避することができます。</p>
<div class="language-python highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">contextlib</span> <span class="kn">import</span> <span class="n">contextmanager</span>
<span class="kn">from</span> <span class="nn">contextvars</span> <span class="kn">import</span> <span class="n">ContextVar</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Iterator</span>

<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">ValidationInfo</span><span class="p">,</span> <span class="n">field_validator</span>

<span class="n">_init_context_var</span> <span class="o">=</span> <span class="n">ContextVar</span><span class="p">(</span><span class="s1">&#39;_init_context_var&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>


<span class="nd">@contextmanager</span>
<span class="k">def</span> <span class="nf">init_context</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="kc">None</span><span class="p">]:</span>
    <span class="n">token</span> <span class="o">=</span> <span class="n">_init_context_var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">yield</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">_init_context_var</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">my_number</span><span class="p">:</span> <span class="nb">int</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__pydantic_validator__</span><span class="o">.</span><span class="n">validate_python</span><span class="p">(</span>
            <span class="n">data</span><span class="p">,</span>
            <span class="n">self_instance</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="n">context</span><span class="o">=</span><span class="n">_init_context_var</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
        <span class="p">)</span>

    <span class="nd">@field_validator</span><span class="p">(</span><span class="s1">&#39;my_number&#39;</span><span class="p">)</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">multiply_with_context</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">info</span><span class="p">:</span> <span class="n">ValidationInfo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">context</span><span class="p">:</span>
            <span class="n">multiplier</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;multiplier&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="o">*</span> <span class="n">multiplier</span>
        <span class="k">return</span> <span class="n">value</span>


<span class="nb">print</span><span class="p">(</span><span class="n">Model</span><span class="p">(</span><span class="n">my_number</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="c1">#&gt; my_number=2</span>

<span class="k">with</span> <span class="n">init_context</span><span class="p">({</span><span class="s1">&#39;multiplier&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">Model</span><span class="p">(</span><span class="n">my_number</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    <span class="c1">#&gt; my_number=6</span>

<span class="nb">print</span><span class="p">(</span><span class="n">Model</span><span class="p">(</span><span class="n">my_number</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="c1">#&gt; my_number=2</span>
</code></pre></div>
<h2 id="reusing-validators">Reusing Validators<a class="headerlink" href="#reusing-validators" title="Permanent link">&para;</a></h2>
<!-- Occasionally, you will want to use the same validator on multiple fields/models (e.g. to normalize some input data).
The "naive" approach would be to write a separate function, then call it from multiple decorators.
Obviously, this entails a lot of repetition and boiler plate code.
The following approach demonstrates how you can reuse a validator so that redundancy is minimized and the models become again almost declarative. -->
<p>場合によっては、複数のフィールド/モデルに対して同じバリデータを使用することもあります(たとえば、一部の入力データを正規化する場合)。
"単純な"アプローチは、別の関数を作成し、複数のデコレータからそれを呼び出すことです。
明らかに、これは多くの繰り返しとボイラープレートコードを必要とします。
次のアプローチでは、冗長性が最小限に抑えられ、モデルが再びほぼ宣言型になるように、バリデータを再利用する方法を示します。</p>
<div class="language-py highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">field_validator</span>


<span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">word</span><span class="o">.</span><span class="n">capitalize</span><span class="p">())</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">))</span>


<span class="k">class</span> <span class="nc">Producer</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>

    <span class="n">_normalize_name</span> <span class="o">=</span> <span class="n">field_validator</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)(</span><span class="n">normalize</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Consumer</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>

    <span class="n">_normalize_name</span> <span class="o">=</span> <span class="n">field_validator</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)(</span><span class="n">normalize</span><span class="p">)</span>


<span class="n">jane_doe</span> <span class="o">=</span> <span class="n">Producer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;JaNe DOE&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">jane_doe</span><span class="p">))</span>
<span class="c1">#&gt; Producer(name=&#39;Jane Doe&#39;)</span>
<span class="n">john_doe</span> <span class="o">=</span> <span class="n">Consumer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;joHN dOe&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">john_doe</span><span class="p">))</span>
<span class="c1">#&gt; Consumer(name=&#39;John Doe&#39;)</span>
</code></pre></div>












                
<script src="/flarelytics/client.js"></script>
    <script>
    window.mkdocs_run_deps = ["pydantic==2.9.0a1", "pydantic-core==2.20.1", "pydantic-extra-types==2.9.0"]
    </script>

              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.tabs.link", "content.code.annotate", "content.code.copy", "navigation.tabs", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.preview", "navigation.instant.progress", "navigation.path", "navigation.sections", "navigation.top", "navigation.tracking", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
        <script src="../../extra/feedback.js"></script>
      
        <script src="../../extra/fluff.js"></script>
      
        <script src="https://samuelcolvin.github.io/mkdocs-run-code/run_code_main.js"></script>
      
    
  </body>
</html>
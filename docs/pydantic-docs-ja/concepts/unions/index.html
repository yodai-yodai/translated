
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Data validation using Python type hints">
      
      
      
        <link rel="canonical" href="https://docs.pydantic.dev/concepts/unions/">
      
      
        <link rel="prev" href="../types/">
      
      
        <link rel="next" href="../alias/">
      
      
      <link rel="icon" href="../../favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.28">
    
    
      
        <title>Unions - Pydantic - 私家版日本語訳(翻訳元Pydantic Version:v2.8.2)</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../extra/terminal.css">
    
      <link rel="stylesheet" href="../../extra/tweaks.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="grey" data-md-color-accent="grey">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#union-modes" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Pydantic - 私家版日本語訳(翻訳元Pydantic Version:v2.8.2)" class="md-header__button md-logo" aria-label="Pydantic - 私家版日本語訳(翻訳元Pydantic Version:v2.8.2)" data-md-component="logo">
      
  <img src="../../logo-white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Pydantic - 私家版日本語訳(翻訳元Pydantic Version:v2.8.2)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Unions
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="grey" data-md-color-accent="grey"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="grey" data-md-color-accent="grey"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/pydantic/pydantic" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    pydantic/pydantic
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
  Get Started

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../models/" class="md-tabs__link">
          
  
  Concepts

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../api/base_model/" class="md-tabs__link">
          
  
  API Documentation

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../examples/secrets/" class="md-tabs__link">
          
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../errors/errors/" class="md-tabs__link">
          
  
  Error Messages

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../integrations/mypy/" class="md-tabs__link">
          
  
  Integrations

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="https://blog.pydantic.dev/" class="md-tabs__link">
        
  
    
  
  Blog

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../pydantic_people/" class="md-tabs__link">
        
  
    
  
  Pydantic People

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Pydantic - 私家版日本語訳(翻訳元Pydantic Version:v2.8.2)" class="md-nav__button md-logo" aria-label="Pydantic - 私家版日本語訳(翻訳元Pydantic Version:v2.8.2)" data-md-component="logo">
      
  <img src="../../logo-white.svg" alt="logo">

    </a>
    Pydantic - 私家版日本語訳(翻訳元Pydantic Version:v2.8.2)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/pydantic/pydantic" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    pydantic/pydantic
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Get Started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Get Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to Pydantic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../why/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Why use Pydantic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../help_with_pydantic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Help with Pydantic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../migration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Migration Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../version-policy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Version Policy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Concepts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Concepts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fields/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fields
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../json_schema/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JSON Schema
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../json/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JSON
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Unions
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Unions
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="Page contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Page contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#union-modes" class="md-nav__link">
    <span class="md-ellipsis">
      Union Modes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Union Modes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#left-to-right-mode" class="md-nav__link">
    <span class="md-ellipsis">
      Left to Right Mode
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smart-mode" class="md-nav__link">
    <span class="md-ellipsis">
      Smart Mode
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Smart Mode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#number-of-valid-fields-set" class="md-nav__link">
    <span class="md-ellipsis">
      Number of valid fields set
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exactness" class="md-nav__link">
    <span class="md-ellipsis">
      Exactness
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#discriminated-unions" class="md-nav__link">
    <span class="md-ellipsis">
      Discriminated Unions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Discriminated Unions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#discriminated-unions-with-str-discriminators" class="md-nav__link">
    <span class="md-ellipsis">
      Discriminated Unions with str discriminators
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#discriminated-unions-with-callable-discriminator" class="md-nav__link">
    <span class="md-ellipsis">
      Discriminated Unions with callable Discriminator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nested-discriminated-unions" class="md-nav__link">
    <span class="md-ellipsis">
      Nested Discriminated Unions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#union-validation-errors" class="md-nav__link">
    <span class="md-ellipsis">
      Union Validation Errors
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../alias/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Alias
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../serialization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Serialization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../validators/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Validators
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataclasses/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dataclasses
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../postponed_annotations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Postponed Annotations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../strict_mode/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Strict Mode
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../type_adapter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Type Adapter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../validation_decorator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Validation Decorator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../conversion_table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Conversion Table
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pydantic_settings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Settings Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../performance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Performance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plugins/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pydantic Plugins
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../experimental/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Experimental
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Documentation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Pydantic
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Pydantic
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/base_model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BaseModel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/root_model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RootModel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/dataclasses/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pydantic Dataclasses
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/type_adapter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TypeAdapter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/validate_call/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Validate Call
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/fields/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fields
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/aliases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Aliases
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/json_schema/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JSON Schema
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/errors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Errors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/functional_validators/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Functional Validators
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/functional_serializers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Functional Serializers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/standard_library_types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Standard Library Types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pydantic Types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/networks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Network Types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/version/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Version Information
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/plugin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pydantic Plugins
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/annotated_handlers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Annotated Handlers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/experimental/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Experimental
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Pydantic Core
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Pydantic Core
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_core/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pydantic_core
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_core_schema/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pydantic_core.core_schema
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_settings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pydantic Settings
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Pydantic Extra Types
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Pydantic Extra Types
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_extra_types_color/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Color
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_extra_types_country/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Country
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_extra_types_payment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Payment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_extra_types_phone_numbers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Phone Numbers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_extra_types_routing_numbers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Routing Numbers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_extra_types_coordinate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Coordinate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_extra_types_mac_address/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mac Address
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_extra_types_isbn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ISBN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_extra_types_pendulum_dt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pendulum
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_extra_types_currency_code/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Currency
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_extra_types_language_code/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Language
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_extra_types_script_code/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Script Code
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_extra_types_semantic_version/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Semantic Version
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_extra_types_timezone_name/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timezone Name
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pydantic_extra_types_ulid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ULID
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/secrets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secrets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/validators/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Validators
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Error Messages
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Error Messages
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../errors/errors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Error Handling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../errors/validation_errors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Validation Errors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../errors/usage_errors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage Errors
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Integrations
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Integrations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
        
          
          <label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Dev Tools
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            Dev Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/mypy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mypy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/pycharm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyCharm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/hypothesis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hypothesis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/visual_studio_code/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Visual Studio Code
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/datamodel_code_generator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    datamodel-code-generator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/devtools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    devtools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/rich/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rich
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/linting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linting
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Production Tools
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            Production Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/aws_lambda/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AWS Lambda
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://blog.pydantic.dev/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blog
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pydantic_people/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pydantic People
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="Page contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Page contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#union-modes" class="md-nav__link">
    <span class="md-ellipsis">
      Union Modes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Union Modes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#left-to-right-mode" class="md-nav__link">
    <span class="md-ellipsis">
      Left to Right Mode
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smart-mode" class="md-nav__link">
    <span class="md-ellipsis">
      Smart Mode
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Smart Mode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#number-of-valid-fields-set" class="md-nav__link">
    <span class="md-ellipsis">
      Number of valid fields set
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exactness" class="md-nav__link">
    <span class="md-ellipsis">
      Exactness
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#discriminated-unions" class="md-nav__link">
    <span class="md-ellipsis">
      Discriminated Unions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Discriminated Unions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#discriminated-unions-with-str-discriminators" class="md-nav__link">
    <span class="md-ellipsis">
      Discriminated Unions with str discriminators
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#discriminated-unions-with-callable-discriminator" class="md-nav__link">
    <span class="md-ellipsis">
      Discriminated Unions with callable Discriminator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nested-discriminated-unions" class="md-nav__link">
    <span class="md-ellipsis">
      Nested Discriminated Unions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#union-validation-errors" class="md-nav__link">
    <span class="md-ellipsis">
      Union Validation Errors
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                

                  

  
  


  <h1>Unions</h1>

<!-- BEGIN INCLUDE ../warning.md -->

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>本サイトのドキュメントは、<a href="https://docs.pydantic.dev/latest/">Pydantic</a>の日本語翻訳の私家版です。</p>
<p>内容に不審な点がある場合は、<a href="https://docs.pydantic.dev/latest/">Pydantic</a>のドキュメントを確認してください。</p>
<p>翻訳に使用したPydanticのバージョンは、v2.8.2になります。</p>
</div>
<!-- END INCLUDE -->

<!-- Unions are fundamentally different to all other types Pydantic validates - instead of requiring all fields/items/values to be valid, unions require only one member to be valid. -->
<p>Unionは、Pydanticが検証する他のすべてのタイプとは根本的に異なります。すべてのフィールド/アイテム/値が有効であることを要求するのではなく、Unionは1つのメンバーのみが有効であることを要求します。</p>
<!-- This leads to some nuance around how to validate unions: -->
<p>これは、Unionの検証方法に関するいくつかのニュアンスにつながります。</p>
<!--
* which member(s) of the union should you validate data against, and in which order?
* which errors to raise when validation fails?
-->
<ul>
<li>Unionのどのメンバーに対して、どのような順序でデータを検証する必要がありますか?</li>
<li>検証が失敗した場合に発生するエラー</li>
</ul>
<!-- Validating unions feels like adding another orthogonal dimension to the validation process. -->
<p>Unionの検証は、検証プロセスに別の直交次元を追加するように感じられます。</p>
<!-- To solve these problems, Pydantic supports three fundamental approaches to validating unions: -->
<p>これらの問題を解決するために、PydanticはUnionを検証するための3つの基本的なアプローチをサポートしています。</p>
<!-- 1. [left to right mode](#left-to-right-mode) - the simplest approach, each member of the union is tried in order and the first match is returned -->
<ol>
<li><a href="#left-to-right-mode">left-to-right mode</a> - 最も簡単な方法で、Unionの各メンバーが順番に試行され、最初の一致が返されます。</li>
</ol>
<!-- 2. [smart mode](#smart-mode) - similar to "left to right mode" members are tried in order; however, validation will proceed past the first match to attempt to find a better match, this is the default mode for most union validation -->
<ol>
<li><a href="#smart-mode">smart mode</a> - "左から右へのモード"と同様に、メンバーは順番に試行されます。ただし、検証は最初の一致を超えて進行し、より適切な一致を見つけようとします。これは、ほとんどのUnion検証のデフォルトモードです。</li>
</ol>
<!-- 3. [discriminated unions](#discriminated-unions) - only one member of the union is tried, based on a discriminator -->
<ol>
<li><a href="#discriminated-unions">識別されたUnion</a> - 識別子に基づいて、Unionの1つのメンバーのみが試行されます。</li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><!-- In general, we recommend using <a href="#discriminated-unions">discriminated unions</a>. They are both more performant and more predictable than untagged unions, as they allow you to control which member of the union to validate against. -->
一般的に、<a href="#discriminated-unions">discriminatedUnion</a>を使用することをお薦めします。これらは、どのUnionのメンバーに対して検証するかを制御できるため、タグなしUnionよりもパフォーマンスが高く、予測可能です。</p>
<p><!-- For complex cases, if you're using untagged unions, it's recommended to use <code>union_mode='left_to_right'</code> if you need guarantees about the order of validation attempts against the union members. -->
複雑なケースでは、タグなしUnionを使用している場合、Unionメンバーに対する検証試行の順序を保証する必要がある場合は、<code>union_mode='left_to_right'</code>を使用することをお勧めします。</p>
<p><!-- If you're looking for incredibly specialized behavior, you can use a <a href="../concepts/validators.md#field-validators">custom validator</a>. -->
非常に特殊な動作を探している場合は、<a href="../validators/#field-validators">custom validator</a>を使用できます。</p>
</div>
<h2 id="union-modes">Union Modes<a class="headerlink" href="#union-modes" title="Permanent link">&para;</a></h2>
<h3 id="left-to-right-mode">Left to Right Mode<a class="headerlink" href="#left-to-right-mode" title="Permanent link">&para;</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><!-- Because this mode often leads to unexpected validation results, it is not the default in Pydantic >=2, instead <code>union_mode='smart'</code> is the default. -->
このモードは予期しない検証結果をもたらすことが多いため、Pydantic&gt;=2ではデフォルトではなく、<code>union_mode='smart'</code>がデフォルトです。</p>
</div>
<!-- With this approach, validation is attempted against each member of the union in their order they're defined, and the first successful validation is accepted as input. -->
<p>この手法では、Unionの各メンバーに対して、定義された順序で検証が試行され、最初に成功した検証が入力として受け入れられます。</p>
<!-- If validation fails on all members, the validation error includes the errors from all members of the union. -->
<p>すべてのメンバーで検証が失敗した場合、検証エラーにはUnionのすべてのメンバーからのエラーが含まれます。</p>
<!-- `union_mode='left_to_right'` must be set as a [`Field`](../concepts/fields.md) parameter on union fields where you want to use it. -->
<p><code>union_mode='left_to_right'</code>は、使用するUnionフィールドの<a href="../fields/"><code>Field</code></a>パラメータとして設定する必要があります。</p>
<div class="language-py highlight"><span class="filename">Union with left to right mode</span><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Union</span>

<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">Field</span><span class="p">,</span> <span class="n">ValidationError</span>


<span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="nb">id</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">union_mode</span><span class="o">=</span><span class="s1">&#39;left_to_right&#39;</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="n">User</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">123</span><span class="p">))</span>
<span class="c1">#&gt; id=123</span>
<span class="nb">print</span><span class="p">(</span><span class="n">User</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;hello&#39;</span><span class="p">))</span>
<span class="c1">#&gt; id=&#39;hello&#39;</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">User</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="p">[])</span>
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    2 validation errors for User</span>
<span class="sd">    id.str</span>
<span class="sd">      Input should be a valid string [type=string_type, input_value=[], input_type=list]</span>
<span class="sd">    id.int</span>
<span class="sd">      Input should be a valid integer [type=int_type, input_value=[], input_type=list]</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
<!-- The order of members is very important in this case, as demonstrated by tweak the above example: -->
<p>この場合、メンバーの順序が非常に重要になります。これは、上記の例を微調整して示しています。</p>
<div class="language-py highlight"><span class="filename">Union with left to right - unexpected results</span><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Union</span>

<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">Field</span>


<span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="nb">id</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">union_mode</span><span class="o">=</span><span class="s1">&#39;left_to_right&#39;</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="n">User</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">123</span><span class="p">))</span>  <span class="c1"># (1)</span>
<span class="c1">#&gt; id=123</span>
<span class="nb">print</span><span class="p">(</span><span class="n">User</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;456&#39;</span><span class="p">))</span>  <span class="c1"># (2)</span>
<span class="c1">#&gt; id=456</span>
</code></pre></div>
<!-- 1. As expected the input is validated against the `int` member and the result is as expected. -->
<ol>
<li>予想通り、入力は<code>int</code>メンバーに対して検証され、結果は予想通りです。</li>
</ol>
<!-- 2. We're in lax mode and the numeric string `'123'` is valid as input to the first member of the union, `int`. Since that is tried first, we get the surprising result of `id` being an `int` instead of a `str`. -->
<ol>
<li>laxモードになっていて、数値文字列<code>'123'</code>がUnionの最初のメンバー<code>int</code>への入力として有効です。これが最初に試行されるので、<code>id</code>が<code>str</code>ではなく<code>int</code>であるという驚くべき結果が得られます。</li>
</ol>
<h3 id="smart-mode">Smart Mode<a class="headerlink" href="#smart-mode" title="Permanent link">&para;</a></h3>
<!-- Because of the potentially surprising results of `union_mode='left_to_right'`, in Pydantic >=2 the default mode for `Union` validation is `union_mode='smart'`. -->
<p><code>union_mode='left_to_right'</code>は意外な結果をもたらす可能性があるため、Pydantic&gt;=2では<code>Union</code>検証のデフォルトモードは<code>union_mode='smart'</code>です。</p>
<!-- In this mode, pydantic attempts to select the best match for the input from the union members. The exact algorithm may change between Pydantic minor releases to allow for improvements in both performance and accuracy. -->
<p>このモードでは、pydanticはUnionメンバからの入力に最も一致するものを選択しようとします。正確なアルゴリズムは、パフォーマンスと精度の両方を向上させるために、Pydanticのマイナーリリース間で変更される可能性があります。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><!-- We reserve the right to tweak the internal <code>smart</code> matching algorithm in future versions of Pydantic. If you rely on very specific  matching behavior, it's recommended to use <code>union_mode='left_to_right'</code> or <a href="#discriminated-unions">discriminated unions</a>. -->
Pydanticの将来のバージョンでは、内部の<code>smart</code>マッチングアルゴリズムを微調整する権利を留保します。非常に特殊なマッチング動作に依存している場合は、<code>union_mode='left_to_right'</code>または<a href="#discriminated-unions">discriminated unions</a>を使用することをお勧めします。</p>
</div>
<details class="info">
<summary>Smart Mode Algorithm</summary>
<p><!-- The smart mode algorithm uses two metrics to determine the best match for the input: -->
スマートモードアルゴリズムは、次の2つのメトリックを使用して、入力の最適な一致を判断します。</p>
<p><!-- 1. The number of valid fields set (relevant for models, dataclasses, and typed dicts)
2. The exactness of the match (relevant for all types) -->
1. 有効なフィールドセットの数(モデル、データクラス、および型指定された辞書に関連)
2. 一致の正確さ(すべてのタイプに関連)</p>
<h4 id="number-of-valid-fields-set">Number of valid fields set<a class="headerlink" href="#number-of-valid-fields-set" title="Permanent link">&para;</a></h4>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><!-- This metric was introduced in Pydantic v2.8.0. Prior to this version, only exactness was used to determine the best match. -->
このメトリックは、Pydantic v2.8.0で導入されました。このバージョン以前は、正確さのみを使用して最適な一致を決定していました。</p>
</div>
<p><!-- This metric is currently only relevant for models, dataclasses, and typed dicts. -->
このメトリックは現在、モデル、データクラス、および型付き辞書にのみ関連しています。</p>
<p><!-- The greater the number of valid fields set, the better the match. The number of fields set on nested models is also taken into account.
These counts bubble up to the top-level union, where the union member with the highest count is considered the best match. -->
設定された有効なフィールドの数が多いほど、一致度が高くなります。ネストされたモデルに設定されたフィールドの数も考慮されます。
これらのカウントは最上位レベルのUnionまでバブルアップされ、最も高いカウントを持つUnionメンバーが最適な一致と見なされます。</p>
<p>For data types where this metric is relevant, we prioritize this count over exactness. For all other types, we use solely exactness.
このメトリックが関連するデータ型では、このカウントが正確さよりも優先されます。その他のすべてのデータ型では、正確さのみが使用されます。</p>
<h4 id="exactness">Exactness<a class="headerlink" href="#exactness" title="Permanent link">&para;</a></h4>
<p><!-- For <code>exactness</code>, Pydantic scores a match of a union member into one of the following three groups (from highest score to lowest score): -->
<code>正確さ</code>のために、Pydanticは組合員の試合を次の3つのグループのいずれかに採点します(最高得点から最低得点まで)。</p>
<p><!--
- An exact type match, for example an <code>int</code> input to a <code>float | int</code> union validation is an exact type match for the <code>int</code> member
- Validation would have succeeded in <a href="../concepts/strict_mode.md">klzzwxh:0100 mode</a>
- Validation would have succeeded in lax mode
-->
- 正確な型の一致。たとえば、<code>float int</code>Union検証への<code>int</code>入力は、<code>int</code>メンバーの正確な型の一致です。
- 検証は<a href="../strict_mode/"><code>strict</code>モード</a>で成功します。
- 検証はlaxモードで成功します。</p>
<p><!-- The union match which produced the highest exactness score will be considered the best match. -->
最も高い正確さのスコアを生成したUnionマッチが、ベストマッチと見なされます。</p>
<p><!-- In smart mode, the following steps are taken to try to select the best match for the input: -->
スマートモードでは、入力に最適なものを選択するために次の手順が実行されます。</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1"><code>BaseModel</code>, <code>dataclass</code>, and <code>TypedDict</code></label><label for="__tabbed_1_2">All other data types</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><!-- 1. Union members are attempted left to right, with any successful matches scored into one of the three exactness categories described above, with the valid fields set count also tallied. -->
1. Union・メンバーは左から右に試行され、成功した一致は前述の3つの正確さのカテゴリーのいずれかにスコア付けされ、有効なフィールド・セット・カウントも集計されます。
<!-- 2. After all members have been evaluated, the member with the highest "valid fields set" count is returned. -->
2. すべてのメンバーが評価された後、"有効なフィールド・セット"カウントが最も高いメンバーが戻されます。
<!-- 3. If there's a tie for the highest "valid fields set" count, the exactness score is used as a tiebreaker, and the member with the highest exactness score is returned. -->
3. 最大の"有効フィールド・セット"カウントに対してタイがある場合、正確さのスコアがタイ・ブレーカーとして使用され、正確さのスコアが最も高いメンバーが戻されます。
<!-- 4. If validation failed on all the members, return all the errors. -->
4. すべてのメンバーで検証が失敗した場合は、すべてのエラーが戻されます。</p>
</div>
<div class="tabbed-block">
<p><!-- 1. Union members are attempted left to right, with any successful matches scored into one of the three exactness categories described above. -->
1. Unionは左から右に試みられ、成功した試合は上記の3つの正確さのカテゴリーのいずれかに得点されます。
    <!-- - If validation succeeds with an exact type match, that member is returned immediately and following members will not be attempted. -->
    - 型が完全に一致して検証が成功した場合、そのメンバーはすぐに戻され、後続のメンバーは試行されません。
<!-- 2. If validation succeeded on at least one member as a "strict" match, the leftmost of those "strict" matches is returned. -->
2. 少なくとも1つのメンバーで検証が"厳密な"一致として成功した場合、それらの"厳密な"一致のうち最も左のものが戻されます。
<!-- 3. If validation succeeded on at least one member in "lax" mode, the leftmost match is returned. -->
3. "lax"モードで少なくとも1つのメンバーの検証が成功した場合、一番左の一致が戻されます。
<!-- 4. Validation failed on all the members, return all the errors. -->
4. すべてのメンバーで検証が失敗すると、すべてのエラーが戻されます。</p>
</div>
</div>
</div>
</details>
<div class="language-py highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Union</span>
<span class="kn">from</span> <span class="nn">uuid</span> <span class="kn">import</span> <span class="n">UUID</span>

<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span>


<span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="nb">id</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">UUID</span><span class="p">]</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>


<span class="n">user_01</span> <span class="o">=</span> <span class="n">User</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;John Doe&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">user_01</span><span class="p">)</span>
<span class="c1">#&gt; id=123 name=&#39;John Doe&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">user_01</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<span class="c1">#&gt; 123</span>
<span class="n">user_02</span> <span class="o">=</span> <span class="n">User</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;1234&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;John Doe&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">user_02</span><span class="p">)</span>
<span class="c1">#&gt; id=&#39;1234&#39; name=&#39;John Doe&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">user_02</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<span class="c1">#&gt; 1234</span>
<span class="n">user_03_uuid</span> <span class="o">=</span> <span class="n">UUID</span><span class="p">(</span><span class="s1">&#39;cf57432e-809e-4353-adbd-9d5c0d733868&#39;</span><span class="p">)</span>
<span class="n">user_03</span> <span class="o">=</span> <span class="n">User</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">user_03_uuid</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;John Doe&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">user_03</span><span class="p">)</span>
<span class="c1">#&gt; id=UUID(&#39;cf57432e-809e-4353-adbd-9d5c0d733868&#39;) name=&#39;John Doe&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">user_03</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<span class="c1">#&gt; cf57432e-809e-4353-adbd-9d5c0d733868</span>
<span class="nb">print</span><span class="p">(</span><span class="n">user_03_uuid</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<span class="c1">#&gt; 275603287559914445491632874575877060712</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><!-- The type <code>Optional[x]</code> is a shorthand for <code>Union[x, None]</code>. -->
型<code>Optional[x]</code>は<code>Union[x, None]</code>の省略形です。</p>
<p><!-- See more details in <a href="../concepts/models.md#required-fields">Required fields</a>. -->
詳細については、<a href="../models/#required-fields">Required fields</a>を参照してください。</p>
</div>
<h2 id="discriminated-unions">Discriminated Unions<a class="headerlink" href="#discriminated-unions" title="Permanent link">&para;</a></h2>
<!-- **Discriminated unions are sometimes referred to as "Tagged Unions".** -->
<p><strong>識別されたUnionは、"タグ付きUnion"と呼ばれることがあります。</strong></p>
<!-- We can use discriminated unions to more efficiently validate `Union` types, by choosing which member of the union to validate against. -->
<p>識別されたUnionを使用して、どのUnionのメンバーに対して検証するかを選択することで、<code>Union</code>タイプをより効率的に検証することができる。</p>
<!-- This makes validation more efficient and also avoids a proliferation of errors when validation fails. -->
<p>これにより、検証がより効率的になり、検証が失敗した場合のエラーの急増も回避されます。</p>
<!-- Adding discriminator to unions also means the generated JSON schema implements the [associated OpenAPI specification](https://github.com/OAI/OpenAPI-Specification/blob/main/versions/3.1.0.md#discriminator-object). -->
<p>Unionに識別子を追加することは、生成されたJSONスキーマが<a href="https://github.com/OAI/OpenAPI-Specification/blob/main/versions/3.1.0.md#discriminator-object">associated OpenAPI specification</a>を実装することも意味します。</p>
<h3 id="discriminated-unions-with-str-discriminators">Discriminated Unions with <code>str</code> discriminators<a class="headerlink" href="#discriminated-unions-with-str-discriminators" title="Permanent link">&para;</a></h3>
<!-- Frequently, in the case of a `Union` with multiple models, there is a common field to all members of the union that can be used to distinguish which union case the data should be validated against; this is referred to as the "discriminator" in [OpenAPI](https://swagger.io/docs/specification/data-models/inheritance-and-polymorphism/). -->
<p>多くの場合、複数のモデルを持つ<code>Union</code>の場合、Unionのすべてのメンバーに共通のフィールドがあり、どのUnionケースに対してデータを検証すべきかを区別するために使用できます。これは、<a href="https://swagger.io/docs/specification/data-models/inheritance-and-polymorphism/">OpenAPI</a>では"識別子"と呼ばれています。</p>
<!-- To validate models based on that information you can set the same field - let's call it `my_discriminator` - in each of the models with a discriminated value, which is one (or many) `Literal` value(s). -->
<p>その情報に基づいてモデルを検証するには、同じフィールド(<code>my_discriminator</code>と呼びましょう)を、1つ(または複数)の<code>Literal</code>値である識別された値を持つ各モデルに設定します。</p>
<!-- For your `Union`, you can set the discriminator in its value: `Field(discriminator='my_discriminator')`. -->
<p><code>Union</code>では、<code>Field(discriminator='my_discriminator')</code>の値に識別子を設定することができます。</p>
<div class="language-py highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Literal</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">Field</span><span class="p">,</span> <span class="n">ValidationError</span>


<span class="k">class</span> <span class="nc">Cat</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">pet_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;cat&#39;</span><span class="p">]</span>
    <span class="n">meows</span><span class="p">:</span> <span class="nb">int</span>


<span class="k">class</span> <span class="nc">Dog</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">pet_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;dog&#39;</span><span class="p">]</span>
    <span class="n">barks</span><span class="p">:</span> <span class="nb">float</span>


<span class="k">class</span> <span class="nc">Lizard</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">pet_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;reptile&#39;</span><span class="p">,</span> <span class="s1">&#39;lizard&#39;</span><span class="p">]</span>
    <span class="n">scales</span><span class="p">:</span> <span class="nb">bool</span>


<span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">pet</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Cat</span><span class="p">,</span> <span class="n">Dog</span><span class="p">,</span> <span class="n">Lizard</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;pet_type&#39;</span><span class="p">)</span>
    <span class="n">n</span><span class="p">:</span> <span class="nb">int</span>


<span class="nb">print</span><span class="p">(</span><span class="n">Model</span><span class="p">(</span><span class="n">pet</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;pet_type&#39;</span><span class="p">:</span> <span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;barks&#39;</span><span class="p">:</span> <span class="mf">3.14</span><span class="p">},</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="c1">#&gt; pet=Dog(pet_type=&#39;dog&#39;, barks=3.14) n=1</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">Model</span><span class="p">(</span><span class="n">pet</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;pet_type&#39;</span><span class="p">:</span> <span class="s1">&#39;dog&#39;</span><span class="p">},</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    1 validation error for Model</span>
<span class="sd">    pet.dog.barks</span>
<span class="sd">      Field required [type=missing, input_value={&#39;pet_type&#39;: &#39;dog&#39;}, input_type=dict]</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
<h3 id="discriminated-unions-with-callable-discriminator">Discriminated Unions with callable <code>Discriminator</code><a class="headerlink" href="#discriminated-unions-with-callable-discriminator" title="Permanent link">&para;</a></h3>
<details class="api">
<summary>API Documentation</summary>
<p><a class="autorefs autorefs-internal" href="../../api/types/#pydantic.types.Discriminator"><code>pydantic.types.Discriminator</code></a><br></p>
</details>
<!-- In the case of a `Union` with multiple models, sometimes there isn't a single uniform field across all models that you can use as a discriminator.
This is the perfect use case for a callable `Discriminator`. -->
<p>複数のモデルを持つ<code>Union</code>の場合、すべてのモデルにわたって識別子として使用できる単一の均一なフィールドが存在しないことがあります。
これは、呼び出し可能な<code>Discriminator</code>の完璧なユースケースです。</p>
<div class="language-py highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Literal</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">from</span> <span class="nn">typing_extensions</span> <span class="kn">import</span> <span class="n">Annotated</span>

<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">Discriminator</span><span class="p">,</span> <span class="n">Tag</span>


<span class="k">class</span> <span class="nc">Pie</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">time_to_cook</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">num_ingredients</span><span class="p">:</span> <span class="nb">int</span>


<span class="k">class</span> <span class="nc">ApplePie</span><span class="p">(</span><span class="n">Pie</span><span class="p">):</span>
    <span class="n">fruit</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;apple&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;apple&#39;</span>


<span class="k">class</span> <span class="nc">PumpkinPie</span><span class="p">(</span><span class="n">Pie</span><span class="p">):</span>
    <span class="n">filling</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;pumpkin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;pumpkin&#39;</span>


<span class="k">def</span> <span class="nf">get_discriminator_value</span><span class="p">(</span><span class="n">v</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">v</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;fruit&#39;</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;filling&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s1">&#39;fruit&#39;</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s1">&#39;filling&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>


<span class="k">class</span> <span class="nc">ThanksgivingDinner</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">dessert</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="n">Union</span><span class="p">[</span>
            <span class="n">Annotated</span><span class="p">[</span><span class="n">ApplePie</span><span class="p">,</span> <span class="n">Tag</span><span class="p">(</span><span class="s1">&#39;apple&#39;</span><span class="p">)],</span>
            <span class="n">Annotated</span><span class="p">[</span><span class="n">PumpkinPie</span><span class="p">,</span> <span class="n">Tag</span><span class="p">(</span><span class="s1">&#39;pumpkin&#39;</span><span class="p">)],</span>
        <span class="p">],</span>
        <span class="n">Discriminator</span><span class="p">(</span><span class="n">get_discriminator_value</span><span class="p">),</span>
    <span class="p">]</span>


<span class="n">apple_variation</span> <span class="o">=</span> <span class="n">ThanksgivingDinner</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span>
    <span class="p">{</span><span class="s1">&#39;dessert&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;fruit&#39;</span><span class="p">:</span> <span class="s1">&#39;apple&#39;</span><span class="p">,</span> <span class="s1">&#39;time_to_cook&#39;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span> <span class="s1">&#39;num_ingredients&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}}</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">apple_variation</span><span class="p">))</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">ThanksgivingDinner(dessert=ApplePie(time_to_cook=60, num_ingredients=8, fruit=&#39;apple&#39;))</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">pumpkin_variation</span> <span class="o">=</span> <span class="n">ThanksgivingDinner</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s1">&#39;dessert&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;filling&#39;</span><span class="p">:</span> <span class="s1">&#39;pumpkin&#39;</span><span class="p">,</span>
            <span class="s1">&#39;time_to_cook&#39;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span>
            <span class="s1">&#39;num_ingredients&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">pumpkin_variation</span><span class="p">))</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">ThanksgivingDinner(dessert=PumpkinPie(time_to_cook=40, num_ingredients=6, filling=&#39;pumpkin&#39;))</span>
<span class="sd">&quot;&quot;&quot;</span>
</code></pre></div>
<!-- `Discriminator`s can also be used to validate `Union` types with combinations of models and primitive types. -->
<p><code>Discriminator</code>は、モデルとプリミティブ型の組み合わせで<code>Union</code>型を検証するためにも使用できます。</p>
<p>For example:</p>
<div class="language-py highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">from</span> <span class="nn">typing_extensions</span> <span class="kn">import</span> <span class="n">Annotated</span>

<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">Discriminator</span><span class="p">,</span> <span class="n">Tag</span><span class="p">,</span> <span class="n">ValidationError</span>


<span class="k">def</span> <span class="nf">model_x_discriminator</span><span class="p">(</span><span class="n">v</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;int&#39;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="nb">dict</span><span class="p">,</span> <span class="n">BaseModel</span><span class="p">)):</span>
        <span class="k">return</span> <span class="s1">&#39;model&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># return None if the discriminator value isn&#39;t found</span>
        <span class="k">return</span> <span class="kc">None</span>


<span class="k">class</span> <span class="nc">SpecialValue</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">value</span><span class="p">:</span> <span class="nb">int</span>


<span class="k">class</span> <span class="nc">DiscriminatedModel</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="n">Union</span><span class="p">[</span>
            <span class="n">Annotated</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Tag</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">)],</span>
            <span class="n">Annotated</span><span class="p">[</span><span class="s1">&#39;SpecialValue&#39;</span><span class="p">,</span> <span class="n">Tag</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">)],</span>
        <span class="p">],</span>
        <span class="n">Discriminator</span><span class="p">(</span><span class="n">model_x_discriminator</span><span class="p">),</span>
    <span class="p">]</span>


<span class="n">model_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}}</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">DiscriminatedModel</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span><span class="n">model_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="c1">#&gt; value=SpecialValue(value=1)</span>

<span class="n">int_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">123</span><span class="p">}</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">DiscriminatedModel</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span><span class="n">int_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="c1">#&gt; value=123</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">DiscriminatedModel</span><span class="o">.</span><span class="n">model_validate</span><span class="p">({</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;not an int or a model&#39;</span><span class="p">})</span>
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>  <span class="c1"># (1)!</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    1 validation error for DiscriminatedModel</span>
<span class="sd">    value</span>
<span class="sd">      Unable to extract tag using discriminator model_x_discriminator() [type=union_tag_not_found, input_value=&#39;not an int or a model&#39;, input_type=str]</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
<!-- 1. Notice the callable discriminator function returns `None` if a discriminator value is not found.
   When `None` is returned, this `union_tag_not_found` error is raised. -->
<ol>
<li>識別子の値が見つからない場合、呼び出し可能な識別子関数が<code>None</code>を返すことに注意してください。
<code>None</code>が返された場合、この<code>union_tag_not_found</code>エラーが発生します。</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><!-- Using the <a href="../concepts/types.md#composing-types-via-annotated">klzzwxh:0064 fields syntax</a> can be handy to regroup the <code>Union</code> and <code>discriminator</code> information. See the next example for more details. -->
<a href="../types/#composing-types-via-annotated"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/typing.html#typing.Annotated"><code>typing.Annotated</code></a>fields syntax</a>を使用すると、<code>Union</code>および<code>discriminator</code>情報を簡単に再グループ化できます。詳細については、次の例を参照してください。</p>
<p><!-- There are a few ways to set a discriminator for a field, all varying slightly in syntax. -->
フィールドに識別子を設定する方法はいくつかありますが、構文はわずかに異なります。</p>
<p><!-- For <code>str</code> discriminators: -->
<code>str</code> 識別子の場合:
<div class="language-text highlight"><pre><span></span><code>some_field: Union[...] = Field(discriminator=&#39;my_discriminator&#39;
some_field: Annotated[Union[...], Field(discriminator=&#39;my_discriminator&#39;)]
</code></pre></div></p>
<p><!-- For callable <code>Discriminator</code>s: -->
呼び出し可能な<code>Discriminator</code>の場合:
<div class="language-text highlight"><pre><span></span><code>some_field: Union[...] = Field(discriminator=Discriminator(...))
some_field: Annotated[Union[...], Discriminator(...)]
some_field: Annotated[Union[...], Field(discriminator=Discriminator(...))]
</code></pre></div></p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><!-- Discriminated unions cannot be used with only a single variant, such as <code>Union[Cat]</code>. -->
識別されたUnionは、<code>Union[Cat]</code>のような単一のバリアントでのみ使用することはできません。</p>
<p><!-- Python changes <code>Union[T]</code> into <code>T</code> at interpretation time, so it is not possible for <code>pydantic</code> to distinguish fields of <code>Union[T]</code> from <code>T</code>. -->
Pythonは解釈時に<code>Union[T]</code>を<code>T</code>に変更するので、<code>pydantic</code>が<code>Union[T]</code>と<code>T</code>のフィールドを区別することはできません。</p>
</div>
<h3 id="nested-discriminated-unions">Nested Discriminated Unions<a class="headerlink" href="#nested-discriminated-unions" title="Permanent link">&para;</a></h3>
<!-- Only one discriminator can be set for a field but sometimes you want to combine multiple discriminators.
You can do it by creating nested `Annotated` types, e.g.: -->
<p>1つのフィールドに設定できる識別子は1つだけですが、複数の識別子を組み合わせたい場合があります。
これを行うには、ネストされた<code>Annotated</code>型を作成します。</p>
<div class="language-py highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Literal</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">from</span> <span class="nn">typing_extensions</span> <span class="kn">import</span> <span class="n">Annotated</span>

<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">Field</span><span class="p">,</span> <span class="n">ValidationError</span>


<span class="k">class</span> <span class="nc">BlackCat</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">pet_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;cat&#39;</span><span class="p">]</span>
    <span class="n">color</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">]</span>
    <span class="n">black_name</span><span class="p">:</span> <span class="nb">str</span>


<span class="k">class</span> <span class="nc">WhiteCat</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">pet_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;cat&#39;</span><span class="p">]</span>
    <span class="n">color</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;white&#39;</span><span class="p">]</span>
    <span class="n">white_name</span><span class="p">:</span> <span class="nb">str</span>


<span class="n">Cat</span> <span class="o">=</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">BlackCat</span><span class="p">,</span> <span class="n">WhiteCat</span><span class="p">],</span> <span class="n">Field</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;color&#39;</span><span class="p">)]</span>


<span class="k">class</span> <span class="nc">Dog</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">pet_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;dog&#39;</span><span class="p">]</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>


<span class="n">Pet</span> <span class="o">=</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Cat</span><span class="p">,</span> <span class="n">Dog</span><span class="p">],</span> <span class="n">Field</span><span class="p">(</span><span class="n">discriminator</span><span class="o">=</span><span class="s1">&#39;pet_type&#39;</span><span class="p">)]</span>


<span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">pet</span><span class="p">:</span> <span class="n">Pet</span>
    <span class="n">n</span><span class="p">:</span> <span class="nb">int</span>


<span class="n">m</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">pet</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;pet_type&#39;</span><span class="p">:</span> <span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;black_name&#39;</span><span class="p">:</span> <span class="s1">&#39;felix&#39;</span><span class="p">},</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="c1">#&gt; pet=BlackCat(pet_type=&#39;cat&#39;, color=&#39;black&#39;, black_name=&#39;felix&#39;) n=1</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">Model</span><span class="p">(</span><span class="n">pet</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;pet_type&#39;</span><span class="p">:</span> <span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">},</span> <span class="n">n</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    1 validation error for Model</span>
<span class="sd">    pet.cat</span>
<span class="sd">      Input tag &#39;red&#39; found using &#39;color&#39; does not match any of the expected tags: &#39;black&#39;, &#39;white&#39; [type=union_tag_invalid, input_value={&#39;pet_type&#39;: &#39;cat&#39;, &#39;color&#39;: &#39;red&#39;}, input_type=dict]</span>
<span class="sd">    &quot;&quot;&quot;</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">Model</span><span class="p">(</span><span class="n">pet</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;pet_type&#39;</span><span class="p">:</span> <span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">},</span> <span class="n">n</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    1 validation error for Model</span>
<span class="sd">    pet.cat.black.black_name</span>
<span class="sd">      Field required [type=missing, input_value={&#39;pet_type&#39;: &#39;cat&#39;, &#39;color&#39;: &#39;black&#39;}, input_type=dict]</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><!-- If you want to validate data against a union, and solely a union, you can use pydantic's <a href="../concepts/type_adapter.md">klzzwxh:0036</a> construct instead of inheriting from the standard <code>BaseModel</code>. -->
Unionのみに対してデータを検証したい場合は、標準の<code>BaseModel</code>から継承する代わりに、pydanticの<a href="../type_adapter/"><code>TypeAdapter</code></a>構文を使用できます。</p>
<p><!-- In the context of the previous example, we have the following: -->
前の例では、次のようになります。</p>
<div class="language-python highlight"><pre><span></span><code><span class="n">type_adapter</span> <span class="o">=</span> <span class="n">TypeAdapter</span><span class="p">(</span><span class="n">Pet</span><span class="p">)</span>

<span class="n">pet</span> <span class="o">=</span> <span class="n">type_adapter</span><span class="o">.</span><span class="n">validate_python</span><span class="p">(</span>
    <span class="p">{</span><span class="s1">&#39;pet_type&#39;</span><span class="p">:</span> <span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;black_name&#39;</span><span class="p">:</span> <span class="s1">&#39;felix&#39;</span><span class="p">}</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">pet</span><span class="p">))</span>
<span class="c1">#&gt; BlackCat(pet_type=&#39;cat&#39;, color=&#39;black&#39;, black_name=&#39;felix&#39;)</span>
</code></pre></div>
</div>
<h2 id="union-validation-errors">Union Validation Errors<a class="headerlink" href="#union-validation-errors" title="Permanent link">&para;</a></h2>
<!-- When `Union` validation fails, error messages can be quite verbose, as they will produce validation errors for each case in the union.
This is especially noticeable when dealing with recursive models, where reasons may be generated at each level of recursion.
Discriminated unions help to simplify error messages in this case, as validation errors are only produced for the case with a matching discriminator value. -->
<p><code>Union</code>の検証が失敗した場合、エラーメッセージは非常に冗長になる可能性があります。なぜなら、エラーメッセージはUnionの各ケースに対して検証エラーを生成するからです。
これは、再帰モデルを処理する場合に特に顕著であり、再帰の各レベルで理由が生成される可能性があります。
識別された結合は、この場合のエラーメッセージを単純化するのに役立つ。検証エラーは、識別値が一致する場合にのみ生成されるからです。</p>
<!-- You can also customize the error type, message, and context for a `Discriminator` by passing these specifications as parameters to the `Discriminator` constructor, as seen in the example below. -->
<p>以下の例に示すように、<code>Discriminator</code>コンストラクタにこれらの指定をパラメータとして渡すことで、<code>Discriminator</code>のエラータイプ、メッセージ、コンテキストをカスタマイズすることもできます。</p>
<div class="language-py highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Union</span>

<span class="kn">from</span> <span class="nn">typing_extensions</span> <span class="kn">import</span> <span class="n">Annotated</span>

<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">Discriminator</span><span class="p">,</span> <span class="n">Tag</span><span class="p">,</span> <span class="n">ValidationError</span>


<span class="c1"># Errors are quite verbose with a normal Union:</span>
<span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s1">&#39;Model&#39;</span><span class="p">]</span>


<span class="k">try</span><span class="p">:</span>
    <span class="n">Model</span><span class="o">.</span><span class="n">model_validate</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}}})</span>
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    4 validation errors for Model</span>
<span class="sd">    x.str</span>
<span class="sd">      Input should be a valid string [type=string_type, input_value={&#39;x&#39;: {&#39;x&#39;: 1}}, input_type=dict]</span>
<span class="sd">    x.Model.x.str</span>
<span class="sd">      Input should be a valid string [type=string_type, input_value={&#39;x&#39;: 1}, input_type=dict]</span>
<span class="sd">    x.Model.x.Model.x.str</span>
<span class="sd">      Input should be a valid string [type=string_type, input_value=1, input_type=int]</span>
<span class="sd">    x.Model.x.Model.x.Model</span>
<span class="sd">      Input should be a valid dictionary or instance of Model [type=model_type, input_value=1, input_type=int]</span>
<span class="sd">    &quot;&quot;&quot;</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">Model</span><span class="o">.</span><span class="n">model_validate</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{}}}})</span>
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    4 validation errors for Model</span>
<span class="sd">    x.str</span>
<span class="sd">      Input should be a valid string [type=string_type, input_value={&#39;x&#39;: {&#39;x&#39;: {}}}, input_type=dict]</span>
<span class="sd">    x.Model.x.str</span>
<span class="sd">      Input should be a valid string [type=string_type, input_value={&#39;x&#39;: {}}, input_type=dict]</span>
<span class="sd">    x.Model.x.Model.x.str</span>
<span class="sd">      Input should be a valid string [type=string_type, input_value={}, input_type=dict]</span>
<span class="sd">    x.Model.x.Model.x.Model.x</span>
<span class="sd">      Field required [type=missing, input_value={}, input_type=dict]</span>
<span class="sd">    &quot;&quot;&quot;</span>


<span class="c1"># Errors are much simpler with a discriminated union:</span>
<span class="k">def</span> <span class="nf">model_x_discriminator</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;str&#39;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="nb">dict</span><span class="p">,</span> <span class="n">BaseModel</span><span class="p">)):</span>
        <span class="k">return</span> <span class="s1">&#39;model&#39;</span>


<span class="k">class</span> <span class="nc">DiscriminatedModel</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">Annotated</span><span class="p">[</span>
        <span class="n">Union</span><span class="p">[</span>
            <span class="n">Annotated</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tag</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">)],</span>
            <span class="n">Annotated</span><span class="p">[</span><span class="s1">&#39;DiscriminatedModel&#39;</span><span class="p">,</span> <span class="n">Tag</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">)],</span>
        <span class="p">],</span>
        <span class="n">Discriminator</span><span class="p">(</span>
            <span class="n">model_x_discriminator</span><span class="p">,</span>
            <span class="n">custom_error_type</span><span class="o">=</span><span class="s1">&#39;invalid_union_member&#39;</span><span class="p">,</span>  <span class="c1"># (1)!</span>
            <span class="n">custom_error_message</span><span class="o">=</span><span class="s1">&#39;Invalid union member&#39;</span><span class="p">,</span>  <span class="c1"># (2)!</span>
            <span class="n">custom_error_context</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;discriminator&#39;</span><span class="p">:</span> <span class="s1">&#39;str_or_model&#39;</span><span class="p">},</span>  <span class="c1"># (3)!</span>
        <span class="p">),</span>
    <span class="p">]</span>


<span class="k">try</span><span class="p">:</span>
    <span class="n">DiscriminatedModel</span><span class="o">.</span><span class="n">model_validate</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}}})</span>
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    1 validation error for DiscriminatedModel</span>
<span class="sd">    x.model.x.model.x</span>
<span class="sd">      Invalid union member [type=invalid_union_member, input_value=1, input_type=int]</span>
<span class="sd">    &quot;&quot;&quot;</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">DiscriminatedModel</span><span class="o">.</span><span class="n">model_validate</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{}}}})</span>
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    1 validation error for DiscriminatedModel</span>
<span class="sd">    x.model.x.model.x.model.x</span>
<span class="sd">      Field required [type=missing, input_value={}, input_type=dict]</span>
<span class="sd">    &quot;&quot;&quot;</span>

<span class="c1"># The data is still handled properly when valid:</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="s1">&#39;a&#39;</span><span class="p">}}}</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">DiscriminatedModel</span><span class="o">.</span><span class="n">model_validate</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">model_dump</span><span class="p">())</span>
<span class="c1">#&gt; {&#39;x&#39;: {&#39;x&#39;: {&#39;x&#39;: &#39;a&#39;}}}</span>
</code></pre></div>
<!--
1. `custom_error_type` is the `type` attribute of the `ValidationError` raised when validation fails.
2. `custom_error_message` is the `msg` attribute of the `ValidationError` raised when validation fails.
3. `custom_error_context` is the `ctx` attribute of the `ValidationError` raised when validation fails.
 -->
<ol>
<li><code>custom_error_type</code>は、検証が失敗したときに発生する<code>ValidationError</code>の<code>type</code>属性です。</li>
<li><code>custom_error_message</code>は、検証が失敗したときに発生する<code>ValidationError</code>の<code>msg</code>属性です。</li>
<li><code>custom_error_context</code>は、検証が失敗したときに発生する<code>ValidationError</code>の<code>ctx</code>属性です。</li>
</ol>
<!-- You can also simplify error messages by labeling each case with a [`Tag`][pydantic.types.Tag].
This is especially useful when you have complex types like those in this example: -->
<p>各ケースに<a class="autorefs autorefs-internal" href="../../api/types/#pydantic.types.Tag"><code>Tag</code></a>というラベルを付けることで、エラーメッセージを簡略化することもできます。
これは、この例のような複雑な型がある場合に特に便利です。</p>
<div class="language-py highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">from</span> <span class="nn">typing_extensions</span> <span class="kn">import</span> <span class="n">Annotated</span>

<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">AfterValidator</span><span class="p">,</span> <span class="n">Tag</span><span class="p">,</span> <span class="n">TypeAdapter</span><span class="p">,</span> <span class="n">ValidationError</span>

<span class="n">DoubledList</span> <span class="o">=</span> <span class="n">Annotated</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">AfterValidator</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)]</span>
<span class="n">StringsMap</span> <span class="o">=</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>


<span class="c1"># Not using any `Tag`s for each union case, the errors are not so nice to look at</span>
<span class="n">adapter</span> <span class="o">=</span> <span class="n">TypeAdapter</span><span class="p">(</span><span class="n">Union</span><span class="p">[</span><span class="n">DoubledList</span><span class="p">,</span> <span class="n">StringsMap</span><span class="p">])</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">adapter</span><span class="o">.</span><span class="n">validate_python</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">])</span>
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">exc_info</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">exc_info</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    2 validation errors for union[function-after[&lt;lambda&gt;(), list[int]],dict[str,str]]</span>
<span class="sd">    function-after[&lt;lambda&gt;(), list[int]].0</span>
<span class="sd">      Input should be a valid integer, unable to parse string as an integer [type=int_parsing, input_value=&#39;a&#39;, input_type=str]</span>
<span class="sd">    dict[str,str]</span>
<span class="sd">      Input should be a valid dictionary [type=dict_type, input_value=[&#39;a&#39;], input_type=list]</span>
<span class="sd">    &quot;&quot;&quot;</span>

<span class="n">tag_adapter</span> <span class="o">=</span> <span class="n">TypeAdapter</span><span class="p">(</span>
    <span class="n">Union</span><span class="p">[</span>
        <span class="n">Annotated</span><span class="p">[</span><span class="n">DoubledList</span><span class="p">,</span> <span class="n">Tag</span><span class="p">(</span><span class="s1">&#39;DoubledList&#39;</span><span class="p">)],</span>
        <span class="n">Annotated</span><span class="p">[</span><span class="n">StringsMap</span><span class="p">,</span> <span class="n">Tag</span><span class="p">(</span><span class="s1">&#39;StringsMap&#39;</span><span class="p">)],</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">tag_adapter</span><span class="o">.</span><span class="n">validate_python</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">])</span>
<span class="k">except</span> <span class="n">ValidationError</span> <span class="k">as</span> <span class="n">exc_info</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">exc_info</span><span class="p">)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    2 validation errors for union[DoubledList,StringsMap]</span>
<span class="sd">    DoubledList.0</span>
<span class="sd">      Input should be a valid integer, unable to parse string as an integer [type=int_parsing, input_value=&#39;a&#39;, input_type=str]</span>
<span class="sd">    StringsMap</span>
<span class="sd">      Input should be a valid dictionary [type=dict_type, input_value=[&#39;a&#39;], input_type=list]</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div>












                
<script src="/flarelytics/client.js"></script>
    <script>
    window.mkdocs_run_deps = ["pydantic==2.9.0a1", "pydantic-core==2.20.1", "pydantic-extra-types==2.9.0"]
    </script>

              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.tabs.link", "content.code.annotate", "content.code.copy", "navigation.tabs", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.preview", "navigation.instant.progress", "navigation.path", "navigation.sections", "navigation.top", "navigation.tracking", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
        <script src="../../extra/feedback.js"></script>
      
        <script src="../../extra/fluff.js"></script>
      
        <script src="https://samuelcolvin.github.io/mkdocs-run-code/run_code_main.js"></script>
      
    
  </body>
</html>